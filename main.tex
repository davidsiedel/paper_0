\section{The HHO method from the mechanical standpoint}

\subsection{Introduction}

% The
% ﬁrst DG method for linear elasticity was proposed and analyzed by Riv-
% ere and Wheeler [39] in 2000; the method is an extension of the
% non-symmetric interior penalty Galerkin (NIPG) method for steady-state
% diffusion problems. In 2002, Hansbo and Larson [31] were the ﬁrst to
% consider the Nitsche's classical DG method for nearly incompressible
% elasticity. They showed, theoretically and numerically, that this method
% is free from volumetric locking. This nice property of DG methods for
% elasticity problems was then considered to be one of the major advan-
% tages over the conforming methods, see Refs. [8,18,42]. In 2003, Lew
% et al. [34] followed the analysis in Ref. [6] to generalize the symmetric
% interior penalty Galerkin (SIPG) method to linear elasticity. The authors
% derived the discrete energy minimization principle for their SIPG
% scheme. In about the same period of time, DG methods were proposed for
% many other linear problems in solid mechanics, such as Timoshenko
% beams [7,8], Bernoulli-Euler beam and the Poisson-Kirchhoff plate [5,
% 21] and Reissner-Mindlin plates [1]. Some variants of DG methods also
% appeared in the literature for elasticity problems, such as discontinuous

The Hybird High Order method (HHO) is a discontinuous discretization
method, that takes root in the Discontinuous Galerkin method (DG). From
the physical standpoint, DG methods ensure the continuity of the flux
across interfaces, by seeking the solution element-wise, hence allowing
jumps of the potential across elements. They can be seen as a
generalization of Finite Volume methods, and are able to capture
physically relevant discontinuities without producing spurious
oscillations.

The origin of DG methods dates back to the pioneering work of
\cite{reed_triangular_1973}, where an hyperbolic formualtion is used to
solve the neutron transport equation. The first application of the
method to elliptic problems originates in \cite{babuska_finite_1973}
where Nitsche's method \cite{nitsche_uber_1970} is used to weakly impose
continuity of the flux across interfaces. \textcolor{blue} { In 2002,
  Hansbo and Larson \cite{hansbo_discontinuous_2002-1} were the first to
  consider the Nitsche's classical DG method for nearly incompressible
  elasticity. They showed, theoretically and numerically, that this
  method is free from volumetric locking. } However, the bilinear form
arising from this formulation is not symmetric. A so called interior
penalty term has been introduced in \cite{wheeler_elliptic_1978},
leading to the Symmetric Interior Penalty (SIP) DG method. A first study
of the method to linear elasticity has been devised by
\cite{riviere_optimal_2000}, where optimal error estimate has been
proved. \textcolor{blue} { \cite{lew_optimal_2004} generalized the
  Symmetric Interior Penalty method to linear elasticity. }
\textcolor{blue} {
  % In 2002, Hansbo and Larson \cite{hansbo_discontinuous_2002-1} were the first to
 % consider the Nitsche's classical DG method for nearly incompressible
  % elasticity. They showed, theoretically and numerically, that this method
 % is free from volumetric locking. % \cite{lew_optimal_2004}
  % generalized the Symmetric
  % Interior Penalty method to linear elasticity. In about the same
  period of time, DG methods were proposed for other linear problems in
  solid mechanics, such as Timoshenko beams
  \cite{celiker_locking-free_2006}, Bernoulli-Euler beam and the
  Poisson-Kirchhoff plate \cite{brenner_balancing_1999,
    engel_continuousdiscontinuous_2002} and Reissner-Mindlin plates
  \cite{arnold_family_2005}. In the mid 2000's, the first applications
  of DG methods to nonlinear elasticity problems was undertaken by
  \cite{ten_eyck_discontinuous_2006, noels_general_2006}, and in 2007,
  Ortner and Süli \cite{ortner_discontinuous_2007} carried out the a
  priori error analysis of DG methods for nonlinear elasticity.
  % This pioneering work
  % shed light on how to calculate a lower bound on the stability parameters.
 }

DG methods then sollicitated a vigourus interest, mostly in fluid dynamics \cite{shahbazi_high-order_2007, persson_discontinuous_2009} due to their local conservative property and stability in convection domniated problems. However, except some applications for instance in fracture mechanics using XFEM methods \cite{gracie_blending_2008, shen_stability_2010}, or gradient plasticity \cite{djoko_discontinuous_2007,djoko_discontinuous_2007-1} DG methods did not break through in computational solid mechanics because of their numerical cost, since nodal unknowns need be duplicated to define local basis functions in each element.

To adress this problem, in the early 2010's, \cite{cockburn_unified_2009, soon_hybridizable_2009} introduced additional faces unknowns on element interfaces for linear elastic problem, hence leading to the hybridization of DG methods, or Hybridizable Discontinuous Galerkin method (HDG). By adding supplementary boundary unknowns, the authors actually allowed to eliminate original cell unknowns by a static condensation process, in order to express the global problem on faces ones only. Extension of HDG methods to non-linear elasticity were first undertaken in \cite{soon_hybridizable_2008} and have then fueled intense reaserch works for various applications such as linear and non-linear convection-diffusion problems \cite{nguyen_implicit_2009,nguyen_implicit_2009-1,nguyen_hybridizable_2010}, incompressible stokes flows \cite{nguyen_hybridizable_2010, nguyen_implicit_2011} and non-linear mechanics \cite{nguyen_hybridizable_2012}.

In \cite{di_pietro_hybrid_2015, di_pietro_arbitrary-order_2014}, the authors introduced a higher order potential reconstruction operator in the classical HDG formulation for elliptic problems, providing a $h^{k+1} H^1$-norm convergence rate as compared to the ususal $h^k$-rate. This higher order term coined the name for the so called HHO method.
Recent developments of HHO methods in
computational mechanics include the incompressible Stokes
equations (with possibly large irrotational forces) \cite{di_pietro_discontinuous_2016}, the
incompressible Navier–Stokes equations \cite{di_pietro_hybrid_2018}, Biot’s consolidation problem \cite{boffi_nonconforming_2016}, and nonlinear elasticity with small
deformations \cite{botti_hybrid_2017}

\textcolor{red}{
    The difference
    between HHO and HDG methods is twofold: (1) the HHO
    reconstruction operator replaces the discrete HDG flux (a
    similar rewriting of an HDG method for nonlinear elastic-
    ity can be found in [29]), and, more importantly, (2) both
    HHO and HDG penalize in a least-squares sense the differ-
    ence between the discrete trace unknown and the trace of the
    discrete primal unknown (with a possibly mesh-dependent
    weight), but HHO uses a non-local operator over each mesh
    cell boundary that delivers one-order higher approximation
    than just penalizing pointwise the difference as in HDG.
    Discretization methods for linear and nonlinear elastic-
    ity have undergone a vigorous development over the last
    decade. For discontinuous Galerkin (dG) methods, we men-
    tion in particular [14,26,32] for linear elasticity, and [35,41]
    for nonlinear elasticity. HDG methods for linear elasticity
    have been coined in [38] (see also [13] for incompressible
    Stokes flows), and extensions to nonlinear elasticity can be
    found in [29,34,37]. Other recent developments in the last few
    years include, among others, Gradient Schemes for nonlinear
    elasticity with small deformations [22], the Virtual Element
    Method (VEM) for linear and nonlinear elasticity with small
    [3] and finite deformations [8,43], the (low-order) hybrid dG
    method with conforming traces for nonlinear elasticity [44],
    the hybridizable weakly conforming Galerkin method with
    nonconforming traces for linear elasticity [30], the Weak
    Galerkin method for linear elasticity [42], and the discon-
    tinuous Petrov–Galerkin method for linear elasticity [7]. 
}

\subsection{Description of the model problem}
\label{sec_10}

Let $d \in  \{1, 2\}$ the euclidean dimension of the cartesian space $\mathbb{R}{}^{d}$, and $\mathcal{R}_d$ the euclidean reference frame. Let $\Omega{}_{} \subset \mathbb{R}{}^{d}$ a solid body with boundary $\partial \Omega{}_{} \subset \mathbb{R}{}^{d - 1}$, that deforms under the volumic load $\tensori{f}{}_{v}$. It is subjected to a prescribed displacement $\tensori{u}{}_{d}$ on the Dirichlet boundary $\partial \Omega{}_{d}$, and to a contact load $\tensori{t}{}_{n}$ on the Neumann boundary $\partial \Omega{}_{n}$, such that $\partial \Omega{}_{} = \partial \Omega{}_{d} \cup \partial \Omega{}_{n}$ and $\partial \Omega{}_{d} \cap \partial \Omega{}_{n} = \emptyset$.

The initial configuration of the body (see Figure \ref{fig_setting}) is denoted $\Omega{}_{0} \in \mathbb{R}{}^{d}$ with respective Dirichlet and Neumann boundaries $\partial \Omega{}_{D}$ and $\partial \Omega{}_{N}$. The transformation mapping $\tensori{\Phi}$ takes a point $\tensori{X} \in \Omega{}_{0}$ to $\tensori{x} \in \Omega{}_{}$, such that $\tensori{x} = \tensori{\Phi}(\tensori{X}) = \tensori{X} + \tensori{u}(\tensori{X})$ where $\tensori{u}$ denotes the displacement of the physical point. Let $\tensorii{F} = \nabla_X \tensori{\Phi} = \tensorii{1} + \nabla_{X} \tensori{u}$ the transformation gradient.
% such that $J = \text{det}(\tensorii{F}) > 0$. In physical terms, $J$ expresses the local voulme variation at $\tensori{X}$ through the transformation $\tensori{\Phi}$.
The mechanical problem to solve reads, find $\tensori{u}$ such that:
\begin{subequations}
\label{eq_0000}
    \begin{alignat}{2}
    \tensorii{F} - \nabla_{X} \tensori{u} & = \tensorii{1} \quad && \text{in } \Omega_{0} \label{eq_0000:eq1}
    \\
    \tensorii{P} - \frac{\partial \psi_{mec}}{\partial \tensorii{F}} & = 0 \quad && \text{in } \Omega_{0} \label{eq_0000:eq2}
    \\
    \nabla_{X} \cdot \tensorii{P} - \tensori{f}{}_{V} & = 0 \quad && \text{in } \Omega_{0} \label{eq_0000:eq3}
    \\
    \tensori{u} & = \tensori{u}{}_{D} \quad && \text{on } \partial_{D} \Omega_{0} \label{eq_0000:eq4}
    \\
    \tensorii{P} \cdot \tensori{n} & = \tensori{t}{}_{N} \quad && \text{on } \partial_{N} \Omega_{0} \label{eq_0000:eq5}
\end{alignat}
\end{subequations}
where $\psi_{mec}$ denotes the mechanical energy potential, and $\tensorii{P}$ the first Piola-Kirchoff stress tensor.
\begin{figure}[H]
\centering
\includegraphics[width=7.cm]{img/mech_setting.png}
\caption{schematic representation of the model problem}
\label{fig_setting}
\end{figure}

% using the divegrence theorem in \eqref{eq1:eq3} for any kinematically admissible displacement $\tensori{v}{} \in H^1_0(\Omega_0, \mathbb{R}^d)$ and injecting \eqref{eq1:eq5} yields the well-known principle of virtual works:
The equilibrium of the body $\Omega_0$ is reached for the displacement field $\tensori{u}{} \in H^1(\Omega_0, \mathbb{R}^d)$ minimizing the energy:

\begin{equation}
    \label{eq_0001}
    \begin{aligned}
        J(\tensori{u}{}) = \int_{\Omega_0} \psi_{mec}(\tensorii{F}) - \int_{\Omega_0} \tensori{f}{}_V \cdot \tensori{u}{}
        +
        \int_{\partial_N \Omega_0} \tensori{t}{}_N \cdot \tensori{u}{}
    \end{aligned}
\end{equation}
where $\tensori{u} \in H^1(\Omega_0, \mathbb{R}^d)$, and equations \eqref{eq_0000:eq1} and \eqref{eq_0000:eq2} are enforced strongly.
If \eqref{eq_0000:eq1} and \eqref{eq_0000:eq2} are considered in weak sense, one obtains the three-field Hu–Washizu functional :
\begin{equation}
\label{eq_0002}
    J(\tensori{u}, \tensorii{G}, \tensorii{P}) =
    \int_{\Omega_0} \psi_{mec}(\tensorii{F}) + (\nabla_X \tensori{u} - \tensorii{G}) : \tensorii{P}
    -
    \int_{\Omega_0} \tensori{f}{}_V \cdot \tensori{u}
    -
    \int_{\partial_N \Omega_0} \tensori{t}{}_N \cdot \tensori{u}
\end{equation}
where $\tensorii{P} \in H^1_{\text{div}}(\Omega_0, \mathbb{R}^d)$, $\tensorii{F} \in L^2(\Omega_0, \mathbb{R}^d)$, and $\tensorii{G} := \tensorii{F} - \tensorii{1}$.


%   Let $U = H^1(\Omega_0, \mathbb{R}^d)$ (resp. $V = H^1_0(\Omega_0, \mathbb{R}^d)$) the space of kinematically admissible displacements (resp. virtual displacements),
% %   where $\tensori{u}{} \in U, \tensori{v}{} \in V$.
%   Similarily, let $S = H^1_{\text{div}}(\Omega_0, \mathbb{R}^{d \times d})$ (resp. $G = H^1(\Omega_0, \mathbb{R}^{d \times d})$) the space of statically admissible stresses (resp displacement gradients),
% %   and $\tensorii{P}{} \in S$, $\tensorii{F}{} \in G$.


%   At this point, let $U(\Omega_0, \mathbb{R}^d)$ the space of kinematically admissible displacements, $\tensori{u}{} \in U$, and $V(\Omega_0, \mathbb{R}^d)$ the space of kinematically admissible virtual displacements, $\tensori{v}{} \in V$. Similarily, let $S(\Omega_0, \mathbb{R}^{d \times d})$ the space of statically admissible stresses, $\tensorii{P}{} \in S$, and $G(\Omega_0, \mathbb{R}^{d \times d})$ that of kinematically admissible displacement gradients (or strains), $\tensorii{F}{} \in G$.
%   The definition of these spaces will be introduced later on in the document.
% In the context of the standard Continuous Galerkin (CG) method, which is at the foundation of the notorious Finite Element (FE) method, $U$ and $V$ belong to the usual Sobolev spaces $\{ \tensori{v}{} \in H^1(\Omega_0, \mathbb{R}^d), \tensori{v}{} = \tensori{u}{}_{D} \text{ on }  \partial_{D} \Omega_{0}\}$ and $\{ \tensori{v}{} \in H^1(\Omega_0, \mathbb{R}^d), \tensori{v}{} = 0 \text{ on }  \partial_{D} \Omega_{0}\}$ respectively, and .

\subsection{Composite element}
\label{sec_11}

% Let $\mathcal{T}_h$ a triangulation of the domain $\Omega$ into a set of disjoints elements (or cells) $T_i \subset \mathbb{R}^{d}, 1 \leq i \leq N$, where $N$ denotes the number of elements in the mesh.
% Let $\alpha$ denote a $n$-tensor-valued field on $\Omega$. The notation $\alpha_{\vert T}$ denotes the restriction of $\alpha$ to the element $T \subset \Omega_0$.
% Let $\partial T$ the boundary of an element $T$, composed of its faces (if $d = 3$) or edges (if $d = 2$).
% soit $\mathcal{T}(\Omega_0)$ une triangulation de $\Omega_0$ en éléments (ou cellules) disjoint(e)s $T \subset \mathbb{R}^d$, où $T$ est polyédrique à faces planes. On note $\partial T \subset \mathbb{R}^{d-1}$ l'ensemble des faces de $T$, et $\mathcal{F}(\Omega_0)$ le squelette du maillage (\textit{i.e.} l'ensemble des faces du maillage), tel que $\mathcal{F}_D(\Omega_0)$ désigne l'ensemble des faces sur $\partial_D \Omega_0$, $\mathcal{F}_N(\Omega_0)$ celui sur $\partial_N \Omega_0$, et $\mathcal{F}_I(\Omega_0)$ l'ensemble des faces internes du maillage, \textit{i.e.} l'ensemble des faces des éléments qui ne partagent pas de frontière avec celle du domaine $\Omega_0$.
% Let $\tensori{v}_{T}$ the displacement field $\tensori{v}$ in an element $T$, and $\tensori{v}_{\partial T}$ that of $\partial T$. Assuming continuity of the displacement on the mesh, one has the natural equality :


Let $\mathcal{T}_h$ a triangulation of the domain $\Omega$ into a set of disjoints elements (or cells) $T_i \subset \mathbb{R}^{d}, 1 \leq i \leq N$, where $N$ denotes the number of elements in the mesh.
Let $\partial T$ the boundary of an element $T$, composed of its faces (if $d = 3$) or edges (if $d = 2$).
Let $\tensori{v}_{T}$ the displacement field $\tensori{v}$ in an element $T$, and $\tensori{v}_{\partial T}$ that of $\partial T$. Assuming continuity of the displacement on the mesh, one has the natural equality :
%
\begin{equation}
\label{eq_0003}
\begin{aligned}
    \tensori{v}_{\partial T} = \tensori{v}_{T \vert \partial T} && \text{on } \partial T
\end{aligned}
\end{equation}

\begin{figure}[H]
    \centering
    \includegraphics[width=7.cm]{img/elem_layers.png}
\end{figure}

In order to lay the ground for the description of (hybrid) discontinuous elements from mechanical arguments based on the ususal assumption of the continuity of the displacement field,
let decompose $T$ into a thin volumic region $\Upsilon \subset \mathbb{R}^{d}$ of width $\ell > 0$ attached to the element boundary $\partial T$, and into a core region $\Xi$, such that $T = \Xi \cup \Upsilon$.
Let $\Xi = \tensori{\Phi}{}_{T}(T)$ the image of $T$ by the homotehty $\tensori{\Phi}{}_{T}$ of ratio $(1 + \alpha \ell)$, with $\alpha < 0$, centered in $\tensori{X}{}_T$ the centroid of $T$.
Let $\partial \Xi = \tensori{\Phi}{}_{T} (\partial T)$ the boundary of $\Xi$; since $\partial \Xi$ is an homotehy of $\partial T$, any point $\tensori{X}{}_{\partial T} \in \partial T$ and $\tensori{X}{}_{\partial \Xi} = \tensori{\Phi}{}_T(\tensori{X}{}_{\partial T}) \in \partial \Xi$ share the same unit outward normal $\tensori{n}{}$.
%
Let $\mathcal{M}_T = \{ v \in L^2(\Upsilon) \ \vert \ v \cdot \tensori{n} = \text{cste} \}$ the set of $L^2$-functions which are constant along the normal axis in $\Upsilon$; for any function in $\mathcal{M}_T$, the following equality holds true:
%
\begin{equation}
    \label{eq_00010}
        \int_{\Upsilon} v \ dV
        =
        \int_{\partial T} \int_{\epsilon = 0}^{\ell} v (1 + \alpha \epsilon) \ dS d \epsilon
        =
        \ell (1 + \frac{\alpha}{2} \ell) \int_{\partial T} v \ dS
\end{equation}
%
Let $\tensori{u}_{\Upsilon} \in H^1(\Upsilon, \mathbb{R}^d)$ the displacement of $\Upsilon$, and $\tensori{u}_{\Xi} \in H^1(\Xi, \mathbb{R}^d)$ that of $\Xi$.
With a similar argument as in \eqref{eq_0003}, $\tensori{u}{}_{\Upsilon}$ verifies:
%
\begin{equation}
\label{eq_0004}
\begin{aligned}
    \tensori{u}_{\Upsilon \vert \partial \Xi} & = \tensori{u}_{\Xi}
    &&
    & \text{on } \partial \Xi
    \\
    % \text{and}
    % \\
    \tensori{u}_{\Upsilon \vert \partial T} & = \tensori{u}_{\partial T}
    &&
    & \text{on } \partial T
\end{aligned}
\end{equation}
%
Assuming the interface $\Upsilon$ to be thin compared to the cell volume $T$, such that $\ell \ll h_T$ is negligeable with respect to $h_T$ the diameter of $T$, let linearize the displacement in $\Upsilon$ with respect to $\tensori{n}$, such that:
%
\begin{equation*}
    \begin{aligned}
        \tensori{u}{}_{\Upsilon} =
        \frac{\tensori{u}{}_{\partial T}
        -
        \tensori{u}{}_{\Xi} \vert_{\partial \Xi}}{\ell} \otimes \tensori{n} \cdot \tensori{X}
        +
        \tensori{u}{}_{\Xi} \vert_{\partial \Xi}
    \end{aligned}
\end{equation*}
%
Hence, the displacement gradient is homogeneous in $\Upsilon$ along $\tensori{n}{}$ such that :
%
\begin{equation}
\label{eq_0005}
\begin{aligned}
    \nabla_X \tensori{u}{}_{\Upsilon}
    =
    \frac{\tensori{u}{}_{\partial T}
    -
    \tensori{u}{}_{\Xi} \vert_{\partial \Xi}}{\ell}
    \otimes \tensori{n}
\end{aligned}
\end{equation}
%
Since $\partial \Xi$ and $\partial T$ are disjoints by introducing $\Upsilon$, \eqref{eq_0003} does not necessarily hold true and the difference $\tensori{u}{}_{\partial T} - \tensori{u}{}_{\Xi} \vert_{\partial \Xi}$ along $\tensori{n}{}$ can have any value.
Let $\tensori{u}{}_{T} \in H^1(T, \mathbb{R}^d)$ the displacement in $T$ such that:
%
\begin{equation}
    \label{eq_0005bis}
    \begin{aligned}
        \tensori{u}{}_{T} = 
        \left\{
            \begin{array}{ll}
                \tensori{u}{}_{\Xi} & \mbox{in } \Xi
                \\
                \tensori{u}{}_{\Upsilon} & \mbox{in } \Upsilon
            \end{array}
        \right.
    \end{aligned}
\end{equation}
%
In particular, $\tensori{u}{}_{T}$ is continuous across $\Upsilon$, since $\tensori{u}{}_{\Upsilon}$ linearily bridges $\tensori{u}{}_{\Xi} \vert_{\partial \Xi}$ to $\tensori{u}{}_{\partial T}$.
Similarily, let $\tensorii{P}{}_{T} \in H^1_{\text{div}}(T, \mathbb{R}^{d \times d})$ the stress in the element $T$, and $\tensorii{G}{}_{T} \in L^2(T, \mathbb{R}^{d \times d})$ the displacement gradient, such that they
are homogeneous in $\Upsilon$ along $\tensori{n}{}$ as $\ell \ll h_T$:
%
\begin{equation*}
    \label{eq_0005bis}
    \begin{aligned}
        \tensorii{P}{}_{T} = 
        \left\{
            \begin{array}{ll}
                \tensorii{P}{}_{\Xi} & \mbox{in } \Xi
                \\
                \tensorii{P}{}_{\Xi} \vert_{\partial \Xi} & \mbox{in } \Upsilon
            \end{array}
        \right.
        &&
        \text{and}
        &&
        \tensorii{G}{}_{T} = 
        \left\{
            \begin{array}{ll}
                \tensorii{G}{}_{\Xi} & \mbox{in } \Xi
                \\
                \tensorii{G}{}_{\Xi} \vert_{\partial \Xi} & \mbox{in } \Upsilon
            \end{array}
        \right.
    \end{aligned}
\end{equation*}
%
The Hu–Washizu functional over the element $T$ writes:
%
\begin{equation}
    \label{eq_0006}
        J_{T}(\tensori{u}{}_{T}, \tensorii{G}{}_{T}, \tensorii{P}{}_{T}) =
        \int_{T} \psi_{T} + (\nabla_X \tensori{u}{}_{T} - \tensorii{G}{}_{T}) : \tensorii{P}{}_{T}
        -
        \int_{T} \tensori{f}{}_V \cdot \tensori{u}{}_{T}
        -
        \int_{\partial_N T} \tensori{t}{}_N \cdot \tensori{u}{}_{\partial T}
\end{equation}
%
specifying $J_T$ over both $\Xi$ and $\Upsilon$ gives:
%
\begin{equation}
    \label{eq_0006bis}
        J_{T}(\tensori{u}{}_{T}, \tensorii{G}{}_{T}, \tensorii{P}{}_{T})
        =
        J_{\Xi}(\tensori{u}{}_{\Xi}, \tensorii{G}{}_{T}, \tensorii{P}{}_{T})
        +
        J_{\Upsilon}(\tensori{u}{}_{\Xi}, \tensori{u}{}_{\partial T}, \tensorii{G}{}_{T}, \tensorii{P}{}_{T})
\end{equation}
%
with :
%
\begin{equation}
    \label{eq_0007}
        J_{\Xi}(\tensori{u}{}_{\Xi}, \tensorii{G}{}_{T}, \tensorii{P}{}_{T}) =
        \int_{\Xi} \psi_{\Xi} + (\nabla_X \tensori{u}{}_{\Xi} - \tensorii{G}{}_{T}) : \tensorii{P}{}_{T}
        -
        \int_{\Xi} \tensori{f}{}_V \cdot \tensori{u}{}_{\Xi}
\end{equation}
%
where $\psi_{\Xi}$ describes the mechanical energy in $\Xi$, and:
%
\begin{equation}
    \label{eq_0008}
        J_{\Upsilon}(\tensori{u}{}_{\Xi}, \tensori{u}{}_{\partial T}, \tensorii{G}{}_{T}, \tensorii{P}{}_{T}) =
        \int_{\Upsilon} \psi_{\Upsilon} + (\nabla_X \tensori{u}{}_{\Upsilon} - \tensorii{G}{}_{T}) : \tensorii{P}{}_{T}
        % -
        % \int_{\Upsilon} \tensori{f}{}_V \cdot \tensori{u}{}_{\Upsilon}
        -
        \int_{\partial_N T} \tensori{t}{}_N \cdot \tensori{u}{}_{\partial T}
\end{equation}
%
In particlaur, we assumed that the volumetric load is concentrated in the core part of the element $\Xi$, and neglegted in the boundary part.
Moreover, let endow the interface $\Upsilon$ with a linear elastic behaviour, such that :
%
\begin{equation}
    \label{eq_0009}
        \psi_{\Upsilon} = \frac{1}{2} \beta \frac{\ell}{h_T} \nabla_X \tensori{u}{}_{\Upsilon} : \nabla_X \tensori{u}{}_{\Upsilon}
\end{equation}
%
where the parameter $\beta$ is the Young modulus of the membrane, and the dimensionless ratio $\ell / h_T$ balances the accumulated energy with the size of the element.
%
Using \eqref{eq_0005} and \eqref{eq_00010} for $\psi_{\Upsilon} \in \mathcal{M}_T$ one can write the expression of the mechanical energy in the membrane as a term only depending on the boundary :
%
\begin{equation}
    \label{eq_00011}
    \begin{aligned}
        \int_{\Upsilon} \psi_{\Upsilon}
        = &
        % \int_{\Upsilon} \frac{\beta \ell}{2 h_T} \nabla_X \tensori{u}{}_{\Upsilon} : \nabla_X \tensori{u}{}_{\Upsilon} d V
        % \\
        % = &
        % \int_{\Upsilon} \frac{\beta }{2 \ell h_T} \lVert \tensori{u}{}_{\partial T} - \tensori{u}{}_{\Xi} \vert_{\partial \Xi} \rVert^2 d V
        % \\
        % = &
        % \int_{\partial T} \int_{\epsilon = 0}^{\ell} \frac{\beta }{2 \ell h_T} \lVert \tensori{u}{}_{\partial T} - \tensori{u}{}_{\Xi} \vert_{\partial \Xi} \rVert^2 (1 + \alpha \epsilon) dS d \epsilon
        % \\
        % = &
        (1 + \frac{\alpha}{2} \ell) \int_{\partial T} \frac{\beta }{2 h_T} \lVert \tensori{u}{}_{\partial T} - \tensori{u}{}_{\Xi} \vert_{\partial \Xi} \rVert^2
    \end{aligned}
\end{equation}
%
using a similar argument for the second volumetric term in \eqref{eq_0008}, one has:
%
\begin{equation}
    \label{eq_00012}
    \begin{aligned}
        \int_{\Upsilon} (\nabla_X \tensori{u}{}_{\Upsilon} - \tensorii{G}{}_{T}) : \tensorii{P}{}_{T}
        = &
        % \int_{\Upsilon} (\tensorii{P}{}_{T} \cdot \tensori{n}{} \cdot \frac{\tensori{u}{}_{\partial T} - \tensori{u}{}_{\Xi} \vert_{\partial \Xi}}{\ell}
        % -
        % \tensorii{G}{}_{T} : \tensorii{P}{}_{T}) dV
        % \\
        % = &
        % \int_{\partial T} \int_{\epsilon = 0}^{\ell} (\tensorii{P}{}_{T} \cdot \tensori{n}{} \cdot \frac{\tensori{u}{}_{\partial T} - \tensori{u}{}_{\Xi} \vert_{\partial \Xi}}{\ell}
        % -
        % \tensorii{G}{}_{T} : \tensorii{P}{}_{T}) (1 + \alpha \epsilon) dS d \epsilon
        % \\
        % = &
        (1 + \frac{\alpha}{2} \ell) (
            \int_{\partial T} \tensorii{P}{}_{T} \cdot \tensori{n}{} \cdot (\tensori{u}{}_{\partial T} - \tensori{u}{}_{\Xi} \vert_{\partial \Xi})
            -
            \ell \int_{\partial T} \tensorii{G}{}_{T} : \tensorii{P}{}_{T}
        )
    \end{aligned}
\end{equation}
hence :
\begin{equation}
    \label{eq_0014}
    \begin{aligned}
        J_{T}(\tensori{u}{}_{\Xi}, \tensori{u}{}_{\partial T}, \tensorii{G}{}_{T}, \tensorii{P}{}_{T})
        = &
        \int_{\Xi} \psi_{\Xi} + (\nabla_X \tensori{u}{}_{\Xi} - \tensorii{G}{}_{T}) : \tensorii{P}{}_{T}
        \\
        & +
        (1 + \frac{\alpha}{2} \ell) \int_{\partial T} \tensorii{P}{}_{T} \cdot \tensori{n}{} \cdot (\tensori{u}{}_{\partial T} - \tensori{u}{}_{\Xi} \vert_{\partial \Xi})
        \\
        & +
        (1 + \frac{\alpha}{2} \ell) \int_{\partial T} \frac{\beta}{2 h_T} \lVert \tensori{u}{}_{\partial T} - \tensori{u}{}_{\Xi} \vert_{\partial \Xi} \rVert^2
        \\
        & -
        (\ell + \frac{\alpha}{2} \ell^2)\int_{\Upsilon} \tensorii{G}{}_{T} : \tensorii{P}{}_{T}
        \\
        & -
        \int_{\Xi} \tensori{f}{}_V \cdot \tensori{u}{}_{\Xi} - \int_{\partial_N T} \tensori{t}{}_N \cdot \tensori{u}{}_{\partial T}
    \end{aligned}
\end{equation}
%
making $\ell \rightarrow 0$, the interface region vanishes such that $\Upsilon \rightarrow \emptyset$ and $\Xi \rightarrow T$, yielding the expression of the Hu–Washizu functional over the element:
%
\begin{equation}
    \label{eq_0015}
    \begin{aligned}
        J_{T}(\tensori{u}{}_{T}, \tensori{u}{}_{\partial T}, \tensorii{G}{}_{T}, \tensorii{P}{}_{T})
        = &
        \int_{T} \psi_{T} + (\nabla_X \tensori{u}{}_{T} - \tensorii{G}{}_{T}) : \tensorii{P}{}_{T}
        \\
        & + \int_{\partial T} \tensorii{P}{}_{T} \cdot \tensori{n}{} \cdot (\tensori{u}{}_{\partial T} - \tensori{u}{}_{T} \vert_{\partial T})
        \\
        & + \int_{\partial T} \frac{\beta}{2 h_T} \lVert \tensori{u}{}_{\partial T} - \tensori{u}{}_{T} \vert_{\partial T} \rVert^2
        \\
        & -
        \int_{T} \tensori{f}{}_V \cdot \tensori{u}{}_{T}
        -
        \int_{\partial_N T} \tensori{t}{}_N \cdot \tensori{u}{}_{\partial T}
    \end{aligned}
\end{equation}
%
Assuming that the displacement is continuous at the boundary $\partial T$ such that \eqref{eq_0003} holds true, then one recovers the usual expression of the Hu–Washizu integral over the element. However, if one considers that $\tensori{u}{}_{\partial T}$ and $\tensori{u}{}_{T}$ are disticnt variables, the functional writes as a function of the four variables $J(\tensori{u}{}_{T}, \tensori{u}{}_{\partial T}, \tensorii{G}{}_{T}, \tensorii{P}{}_{T})$.
%
Differentiating over each variable, and introducing the numerical flux $\tensori{\theta}{}_{\partial T} = \tensorii{P}{}_{T} \cdot \tensori{n}{} + (\beta / h_T) (\tensori{u}{}_{\partial T} - \tensori{u}{}_{T} \vert_{\partial T})$ one obtains the system:
%
\begin{subequations}
    \label{eq_0017}
        \begin{alignat}{3}
            \frac{\partial J}{\partial \tensori{u}{}_{T}} \delta \tensori{u}{}_{T}
            = & \int_{T} (\tensorii{P} : \nabla_X \delta \tensori{u}{}_{T} - \tensori{f}{}_V) \cdot \delta \tensori{u}{}_{T}
            &&
            \ \ \ \ 
            &&
            \forall \delta \tensori{u}{}_{T} \in H^1(T, \mathbb{R}^d)
        \\
            &
            - \int_{\partial T} \tensori{\theta}{}_{\partial T} \cdot \delta \tensori{u}{}_{T}
        \label{eq_0017:eq0}
        \\
            \frac{\partial J}{\partial \tensori{u}{}_{\partial T}} \delta \tensori{u}{}_{\partial T}
            = &
            \int_{\partial T} (\tensori{\theta}{}_{\partial T} - \tensori{t}{}_N) \cdot \delta \tensori{u}{}_{\partial T}
            &&
            \ \ \ \ 
            &&
            \forall \delta \tensori{u}{}_{\partial T} \in H^1(\partial T, \mathbb{R}^d)
        \label{eq_0017:eq1}
        \\
            \frac{\partial J}{\partial \tensorii{G}{}_{T}} \delta \tensorii{G}{}_{T}
            = &
            \int_{T} (\frac{\partial \psi_T}{\partial \tensorii{G}{}_{T}} - \tensorii{P}{}_{T}) : \delta \tensorii{G}{}_{T}
            &&
            \ \ \ \ 
            &&
            \forall \delta \tensorii{G}{}_{T} \in L^2(T, \mathbb{R}^{d \times d})
        \label{eq_0017:eq2}
        \\
            \frac{\partial J}{\partial \tensorii{P}{}_{T}} \delta \tensorii{P}{}_{T}
            = & \int_{T} (\nabla_X \tensori{u}{}_{T} - \tensorii{G}{}_{T} ) : \delta \tensorii{P}{}_{T}
            % \int_{\partial T} (\nabla_X \tensori{u}{}_{T} - \tensorii{G}{}_{T} ) : \delta \tensorii{P}{}_{T}
            % \\
            % &
            % +
            % \int_{\partial T} (\tensori{u}{}_{\partial T} - \tensori{u}{}_{T} \vert_{\partial T}) \otimes \tensori{n}{} : \delta \tensorii{P}{}_{T}
            &&
            \ \ \ \ 
            &&
            \forall \delta \tensorii{P}{}_{T} \in H^1_{\text{div}}(T, \mathbb{R}^{d \times d})
        \label{eq_0017:eq3}
        \\
        &
        +
        \int_{\partial T} (\tensori{u}{}_{\partial T} - \tensori{u}{}_{T} \vert_{\partial T}) \otimes \tensori{n}{} : \delta \tensorii{P}{}_{T}
    \end{alignat}
\end{subequations}
%
% Since $\frac{\partial \psi_T}{\partial \tensorii{G}{}_{T}} \in L^2(T, \mathbb{R}^{d \times d})$ and $\tensorii{P}{}_{T} \in H^1_{\text{div}}(T, \mathbb{R}^{d \times d}) \subset L^2(T, \mathbb{R}^{d \times d})$, \eqref{eq_0017:eq2} is explicit and can be eliminated from the system.
By explicitly eliminating \eqref{eq_0017:eq2} and \eqref{eq_0017:eq3} from the system, one obtains the problem in primal form: find $(\tensori{u}{}_{T}, \tensori{u}{}_{\partial T}) \in H^1(T, \mathbb{R}^d) \times H^1(\partial T, \mathbb{R}^d)$, such that for all $(\delta \tensori{u}{}_{T}, \delta \tensori{u}{}_{\partial T}) \in H^1(T, \mathbb{R}^d) \times H^1(\partial T, \mathbb{R}^d)$
%
\begin{equation}
    \label{eq_0018}
    \begin{aligned}
        dJ=
        \frac{\partial J}{\partial \tensori{u}{}_{T}} \delta \tensori{u}{}_{T}
        +
        \frac{\partial J}{\partial \tensori{u}{}_{\partial T}} \delta \tensori{u}{}_{\partial T}
        =
        0
    \end{aligned}
\end{equation}
%
injetcing \eqref{eq_0017:eq0} and \eqref{eq_0017:eq1} :
%
\begin{equation}
    \label{eq_0019}
    \begin{aligned}
        dJ
        = &
        \int_{T} \tensorii{P}{}_{T} : \nabla_X \delta \tensori{u}{}_{T}
        \\
        & +
        \int_{\partial T} \tensorii{P}{}_{T} \cdot \tensori{n}{} \cdot (\delta \tensori{u}{}_{\partial T} - \delta \tensori{u}{}_{T} \vert_{\partial T})
        \\
        & +
        \int_{\partial T} (\beta / h_T) (\tensori{u}{}_{\partial T} - \tensori{u}{}_{T} \vert_{\partial T}) \cdot (\delta \tensori{u}{}_{\partial T} - \delta \tensori{u}{}_{T} \vert_{\partial T})
        \\
        &
        -
        \int_{\partial T} \tensori{t}{}_N \cdot \delta \tensori{u}{}_{\partial T}
        -
        \int_{T} \tensori{f}{}_V \cdot \delta \tensori{u}{}_{T}
        = 0
    \end{aligned}
\end{equation}
%
using both \eqref{eq_0017:eq2} and \eqref{eq_0017:eq3} :
%
\begin{equation}
    \label{eq_0020}
    \begin{aligned}
        dJ
        & =
        \int_{T} \frac{\partial \psi_T}{\partial \tensorii{G}{}_T} : \delta \tensorii{G}{}_{T}
        \\
        & +
        \int_{\partial T} (\beta / h_T) (\tensori{u}{}_{\partial T} - \tensori{u}{}_{T} \vert_{\partial T}) \cdot (\delta \tensori{u}{}_{\partial T} - \delta \tensori{u}{}_{T} \vert_{\partial T})
        \\
        &
        -
        \int_{\partial T} \tensori{t}{}_N \cdot \delta \tensori{u}{}_{\partial T}
        -
        \int_{T} \tensori{f}{}_V \cdot \delta \tensori{u}{}_{T}
        = 0
    \end{aligned}
\end{equation}
%
where $\delta \tensorii{G}{}_{T}$ (respectively $\tensorii{G}{}_{T}$) solves \eqref{eq_0017:eq3} for the unknowns set $(\delta \tensori{u}{}_{T}, \delta \tensori{u}{}_{\partial T})$ (respectively $(\tensori{u}{}_{T}, \tensori{u}{}_{\partial T})$)





Le problème (\ref{eq_hu_washizu_hho}) discrétisé consiste à chercher l'inconnue $(\tensori{u}{}_{{T}}^l, \tensori{u}{}_{\partial T}^k)$ dans l'espace des polynômes $P^l({T}, \mathbb{R}^d) \times P^k(\partial T, \mathbb{R}^d)$ d'ordre respectivement $l$ et $k$ tels que $k > 0$ avec $k - 1 \leq l \leq k + 1$, et les champs de gradients de déplacement $\tensorii{G}{}_T^k$ et de contraintes $\tensorii{P}{}_T^k$ dans $P^k({T}, \mathbb{R}^{d \times d})$. On définit la force de traction discrète $\tensori{\theta}{}_{\partial T}^{HHO} = \tensorii{P}{}_T^k \cdot \tensori{n} + ({\beta_{mec}}/{h_T}) \tensori{S}_{\partial T}^{k*}$ telle que $\tensori{S}_{\partial T}^{k*}$ est l'opérateur adjoint de l'opérateur de stabilisation $\tensori{S}_{\partial T}^{k}$ définit par:
%
\begin{equation}
    \label{eq_stabilisation}
    \tensori{S}_{\partial T}^{k}(\tensori{v}{}_{T}^l, \tensori{v}{}_{\partial T}^k) = \Pi_{\partial T}^k
    (
    \tensori{v}{}_{\partial T}^k - \tensori{v}{}_{T}^l
    - (\tensori{1}{}-\Pi_{T}^k) \tensori{D}{}_T^{k + 1}
    )
\end{equation}
%
où $\Pi_{\partial T}^k$ et $\Pi_{T}^k$ sont les projecteurs orthogonaux au sens $L^2$ sur $P^k({\partial T}, \mathbb{R}^d)$ et $P^k({T}, \mathbb{R}^d)$ respectivement, et le champ de déplacement $\tensori{D}{}_T^{k + 1} \in P^{k+1}(T, \mathbb{R}^d)$ est solution du problème (\ref{eq_potential}):
%
\begin{equation}
    \label{eq_potential}
    \begin{aligned}
    \int_T (\nabla_X \tensori{D}{}_{T}^{k+1} - \nabla_X \tensori{u}{}_{T}^l) : \nabla_X \tensori{w}{}^{k+1} & = 
    \int_{\partial T} (\tensori{u}{}_{\partial T}^k - \tensori{u}{}_{T}^l) \cdot \nabla_X \tensori{w}{}^{k+1} \tensori{n}{}
    &&
    \forall \tensori{w}{}^{k+1} \in {P}{}^{k+1}(T, \mathbb{R}^d)
    \\
    \int_T \tensori{D}{}_{T}^{k+1} & = \int_T \tensori{u}{}_{T}^{l}
    \end{aligned}
\end{equation}

D'un point de vue numérique, on calcule dans une étape de pré-traitement l'opérateur de stabilisation ${[S]} : (\tensori{v}{}_{T}^l, \tensori{v}{}_{\partial T}^k) \rightarrow \tensori{S}{}_{\partial T}^{k}$ défini par (\ref{eq_stabilisation}) et l'opérateur de dérivation ${[B]} : (\tensori{v}{}_{T}^l, \tensori{v}{}_{\partial T}^k) \rightarrow \tensorii{G}{}_{T}^{k}$ défini par la formulation discrète de (\ref{eq_hu_washizu_hho_1}), de sorte que le problème discrétisé local (\ref{eq_hu_washizu_hho}) ne dépend plus que de l'inconnue primale $(\tensori{u}{}_{T}^l, \tensori{u}{}_{\partial T}^k)$ vérifiant $\forall (\tensori{v}{}_{{T}}^l, \tensori{v}{}_{\partial T}^k) \in P^l({T}, \mathbb{R}^d) \times P^k(\partial T, \mathbb{R}^d)$:
%
\begin{equation}
    \label{eq_ptv_hho}
    \int_{T} \tensorii{P}{}_{T}^k : \tensorii{G}{}_{T}^k
    +
    \int_{\partial_T} \frac{\beta_{mec}}{h_T}
    \tensori{S}_{\partial T}^{k}(\tensori{u}_{T}^l, \tensori{u}_{\partial T}^k)
    \cdot
    \tensori{S}_{\partial T}^{k}(\tensori{v}_{T}^l, \tensori{v}_{\partial T}^k)
    =
    % \sum_{T \in \mathcal{T}(\Omega_0)}
    \int_{\Omega} \tensori{f}{}_{V} \cdot \tensori{v}{}_{T}^l
    +
    % \sum_{\partial T \in \mathcal{F}_N(\Omega_0)}
    \int_{\partial_T}\tensori{t}{}_{N} \cdot \tensori{v}{}_{\partial T}^k
\end{equation}
%
où les contraintes $\tensorii{P}{}_{T}^k$ sont calculées aux points de quadrature par intégration de la loi de comportement. Le principe des travaux virtuels discret à l'échelle de la structure vérifie donc $\forall (\tensori{v}{}_{\mathcal{T}}^l, \tensori{v}{}_{\mathcal{F}}^k) \in P^l(\mathcal{T}, \mathbb{R}^d) \times P^k(\mathcal{F}, \mathbb{R}^d)$:

\begin{equation}
    \label{eq_hho2}
    \begin{aligned}
        \sum_{T \in \mathcal{T}(\Omega_0)}
        \int_{T} \tensorii{P}{}_{T}^k : \tensorii{G}{}_{T}^k + \int_{\partial_T} \frac{\beta_{mec}}{h_T}
        \tensori{S}_{\partial T}^k(\tensori{u}_{T}^l, \tensori{u}_{\partial T}^k) \cdot
        \tensori{S}_{\partial T}^k(\tensori{v}_{T}^l, \tensori{v}_{\partial T}^k)
        = &
        \sum_{T \in \mathcal{T}(\Omega_0)}
        \int_{\Omega} \tensori{f}{}_{V} \cdot \tensori{v}{}_{T}^l
        \\
        & +
        \sum_{\partial T \in \mathcal{F}_N(\Omega_0)}
        \int_{\partial_T}\tensori{t}{}_{N} \cdot \tensori{v}{}_{\partial T}^k
    \end{aligned}
\end{equation}







% Let assume that the composite element $\Xi$ is in equilibrium, \textit{i.e.} there is a displacement $\tensori{u}{}_{\Xi}$ and a stress tensor $\tensorii{P}{}_{\Xi}(\tensorii{F}{}_{\Xi})$ minimizing \eqref{equilibrium_classical},
% where $\tensori{u}{}_{\Xi} = \tensori{u}{}_{T}$ in $T$ and $\tensori{u}{}_{\Xi} = \tensori{u}{}_{\Upsilon}$ in $\Upsilon$. Let $\tensorii{P}{}_{\vert T}$ the stress in $T$ and $\tensorii{P}{}_{\vert \Upsilon}$ that in $\Upsilon$.

% \begin{equation}
%     \label{eq3_hu_washizu}
%         J(\tensori{u}, \tensorii{G}, \tensorii{P}) =
%         \int_{T \cup \Upsilon} \psi_{mec}(\tensorii{F}) + (\nabla_X \tensori{u} - \tensorii{G}) : \tensorii{P}
%         -
%         \int_{T \cup \Upsilon} \tensori{f}{}_V \cdot \tensori{u}
%         -
%         \int_{\partial_N T} \tensori{t}{}_N \cdot \tensori{u}
% \end{equation}
% %
% specifying the expression over both $T$ and $\Upsilon$ yields :
% %
% \begin{equation}
%     \label{eq4_hu_washizu}
%         J(\tensori{u}{}_T, \tensorii{G}{}_T, \tensorii{P}{}_T) =
%         \int_{T} \psi_{mec}(\tensorii{F}{}_T) + (\nabla_X \tensori{u}{}_T - \tensorii{G}{}_T) : \tensorii{P}{}_T
%         +
%         \int_{\Upsilon} \psi_{mec}(\nabla_X \tensori{u}{}_\Upsilon) + (\nabla_X \tensori{u}{}_\Upsilon - \tensorii{G}{}_\Upsilon) : \tensorii{P}{}_\Upsilon
%         -
%         \int_{T} \tensori{f}{}_V \cdot \tensori{u}{}_T
%         -
%         \int_{\partial_N T} \tensori{t}{}_N \cdot \tensori{u}{}_{\partial T}
% \end{equation}
% %
% where we make the assumption that the mechanical energy $\psi_{mec}$ in $\Upsilon$ only depends on $\nabla_X \tensori{u}{}_\Upsilon$, such that :
% %
% \begin{equation}
%     \label{eq5_hu_washizu}
%     \psi_{mec} = \frac{\beta}{2 \ell} \nabla_X \tensori{u}{}_\Upsilon : \nabla_X \tensori{u}{}_\Upsilon
% \end{equation}
% %
% injecting in  :
% %
% \begin{equation}
%     \label{eq4_hu_washizu}
%         J(\tensori{u}{}_T, \tensorii{G}{}_T, \tensorii{P}{}_T) =
%         \int_{T} \psi_{mec}(\tensorii{F}{}_T) + (\nabla_X \tensori{u}{}_T - \tensorii{G}{}_T) : \tensorii{P}{}_T
%         +
%         \int_{\Upsilon} \psi_{mec}(\nabla_X \tensori{u}{}_\Upsilon) + (\nabla_X \tensori{u}{}_\Upsilon - \tensorii{G}{}_\Upsilon) : \tensorii{P}{}_\Upsilon
%         -
%         \int_{T} \tensori{f}{}_V \cdot \tensori{u}{}_T
%         -
%         \int_{\partial_N T} \tensori{t}{}_N \cdot \tensori{u}{}_{\partial T}
% \end{equation}
%

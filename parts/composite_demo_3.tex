\section{Introduction to discontinuous methods through a Hu-Washizu formulation}
\label{sec_composite_demo}

% Many numerical methods
% consider a partition of the body into elementary subsets called \textit{cells}.
% % The equilibrium of the body is then expressed in terms of the sum of the mechanical contribution in each of these cells composing it.
% % The equilibrium of the interface between two cells is then of major 
% For the equilibrium of the whole body to hold, each cell must be in equilibrium with its neighbors, which means that they have to interact and pass information from one another.
% Communication between two cells is ensured by knowledge of the displacement field at their shared boundary.
% For \textit{conformal} methods to which belongs the Lagrange (\textit{i.e.} the standard) Finite Element Method, the displacement over the whole body is continuous, which implies that the displacement at a cell boundary is directly equal to that of its neighbors, and a cell has a direct knowledge of the motion of its neighborhood.
% For so-called \textit{non-conformal} methods, among which are \textit{e.g.} Discontinuous Galerkin methods, Hybrid Discontinuous Galerkin methods and Hybrid High Order methods, the displacement continuity at a cell boundary is not explicitly enforced, such that one needs to introduce supplementary ingredients in the formulation to pass information from one cell to another. A straightforward way of doing so consists in introducing an interface between cells, that acts as a membrane pulling them together. One can readily feel that the stiffer the membrane, the closer the cells, and the closer to the \textit{conformal} framework. This technique is the one at the foundation of Discontinuous Galerkin methods. By adding an intermediate structure in the membrane, called a \textit{bone}, one defines the framework of Hybrid Discontinuous Galerkin methods and Hybrid High Order methods; the membrane is split into two parts, one at each side of the bone, and communication between cells transits through the bone, via the membrane. The term hybrid expresses the fact that both cells and bones carry information about the displacement field, hence introducing the \textit{skeleton} of the body.
% In the following section, we show that one recovers the full mathematical framework proper to these non-conformal method, by writing the equilibrium of a cell and its interface with its neighborhood.

% Many numerical methods consider a partition of the body into
% elementary parts. % subsets called \textit{cells}.

In this section let $\cell$ a subpart of the body
\(\bodyLag\).
In the following, one assumes that the cell $\cell$ is located inside the body $\bodyLag{}$, such that its boundary $\dCell{}$ bears contact loads only.
This subpart is in equilibrium with the rest of the body
\(\Omega\backslash T\) if the displacements and the normal traction are
continuous at the boundary $\dCell{}$.


\paragraph{Conformal methods} Enforcing the displacement continuity at the interface leads to
so-called conformal methods, to which the standard finite element
methods belongs (see Figure \ref{fig_02}(a)).

\paragraph{Discontinuous Galerkin methods} On the contrary, this condition can be weakened by introducting an
elastic interface of negligible size between \(T\) and
\(\Omega\backslash T\). This representation is at the basis of Discontinuous Galerkin
methods (see Figure \ref{fig_02}(b)).

\paragraph{Hybird Discontinuous Galerkin methods} In this paper, we consider HDG and HHO methods where two elastic
interfaces are introducted: one between \(T\) and its boundary
\(\partial T\) and a second one between \(\Omega\backslash T\) and
\(\partial T\) (see Figure \ref{fig_02}(c)).

Following this idea, we show in this section how the use of the
Hu-Hashizu Lagrangian allows to recover the main ingredients of the
HDG/HHO methods, namely the \textit{reconstructed gradient} and the \textit{stabilisation
operator}.

%% The equilibrium of the body is then expressed in terms of the sum of the mechanical contribution in each of these cells composing it.
%% The equilibrium of the interface between two cells is then of major 
%For the equilibrium of the whole body to hold, each cell must be in
%equilibrium with its neighbors, which means that they have to interact
%and pass information from one another. Communication between two cells
%is ensured by knowledge of the displacement field at their shared
%boundary.
%
%For \textit{conformal} methods to which belongs the Lagrange
%(\textit{i.e.} the standard) Finite Element Method, the displacement
%over the whole body is continuous, which implies that the displacement
%at a cell boundary is directly equal to that of its neighbors, and a
%cell has a direct knowledge of the motion of its neighborhood.
%
%For so-called \textit{non-conformal} methods, among which are
%\textit{e.g.} Discontinuous Galerkin methods, Hybrid Discontinuous
%Galerkin methods and Hybrid High Order methods, the displacement
%continuity at a cell boundary is not explicitly enforced, such that one
%needs to introduce supplementary ingredients in the formulation to pass
%information from one cell to another. A straightforward way of doing so
%consists in introducing an interface between cells, that acts as a
%membrane pulling them together. One can readily feel that the stiffer
%the membrane, the closer the cells, and the closer to the
%\textit{conformal} framework. This technique is the one at the
%foundation of Discontinuous Galerkin methods. By adding an intermediate
%structure in the membrane, called a \textit{bone}, one defines the
%framework of Hybrid Discontinuous Galerkin methods and Hybrid High Order
%methods; the membrane is split into two parts, one at each side of the
%bone, and communication between cells transits through the bone, via the
%membrane. The term hybrid expresses the fact that both cells and bones
%carry information about the displacement field, hence introducing the
%\textit{skeleton} of the body. In the following section, we show that
%one recovers the full mathematical framework proper to these
%non-conformal method, by writing the equilibrium of a cell and its
%interface with its neighborhood.
%%  cells must stick together in order to pass the mechanical information from one cell to another

%  cells must stick together in order to pass the mechanical information from one cell to another

% Let $\cell$ be
% such a cell and let $\dCell{}$ its boundary.
% % For the sake of
% % simplicity, the intersection of $\dCell{}$ and $\dBodyLag{}$
% % is first assumed empty. This special case is treated later.

% In the framework of conforming Galerkin methods, the displacement field is continuous at cells interfaces, and the equilibrium is expressed on the whole structure.
% For discontinuous Galerkin methods, the displacement continuity is broken, to ensure continuity of the flux between cells instead, such that the equilibrium of the whole structure is the sum of the equilibrium expressed within each cell.
% In this section, we show that this change of paradigm amounts to consider that a cell in the continuous framework is surrounded by an infinitely thin elastic interface.

% Let the equilibrium of a cell $\cell$
% %
% %
% %
% \begin{equation}
%     \label{eq_element}
%     L_{\cell}^{eq}
%     % (\tensori{u}{}_{\cell}, \tensorii{G}{}_{\cell}, \tensorii{P}{}_{\cell})
%     =
%     \int_{\cell} \mecPotential_{\bodyLag{}} + (\nabla \tensori{u}{}_{\cell} - \tensorii{G}{}_{\cell}) : \tensorii{P}{}_{\cell}
%     -
%     \int_{\cell} \loadLag \cdot \tensori{u}{}_{\cell}
%     % -
%     % \int_{\Crown} \loadLag \cdot \tensori{u}{}_{\Crown}
%     -
%     \int_{\neumannCell} \neumannCellLoad \cdot \tensori{u}{}_{\dCell}
% \end{equation}
% %
% %
% %
% One can either choose a suitable functional space such that the displacement is continuous at the interfaces, or 


% Je pense vraiment qu'il faut exprimer explicitement l'équilibre d'un élément avec le reste de la structure (tractions normales et continuité des déplacement), préciser que l'on peut imposer les continuités du déplacement au sens fort ou au sens faible et **ensuite** classifier les méthodes ainsi:
% Les éléments finis standards assurent la continuité des déplacements aux interfaces
% Les DG relient directement les éléments entre eux et pénalisent les sauts de déplacement entre les éléments
% Les HDG et HHO relient les éléments à leurs frontières et pénalisent les sauts de déplacement entre l'élément et la frontière

% Puis on indique qu'un moyen pratique de pénaliser les sauts de déplacement est d'introduire une interphase élastique de faible épaisseur et de faire tendre cette épaisseur vers 0.  Dans le cadre de ce papier, seules les méthodes HDG et HHO sont traitées (et donc pas les DG).

% Cette section montre que l'application de Hu-Hashizu à l'élément à son interphase permet de retrouver tous les ingrédients principaux des méthodes HDG et HH0: le gradient reconstruit et l'opérateur de stabilisation.

\subsection{Element description}

\paragraph{Element geometry}

In the following, the cell $\cell$ is assumed to be convex.
It is split into a core part $\Bulk \subset \cell$ with boundary $\dBulk$, and into an interface part $\Crown{} \subset \cell$ with boundary $\dCrown = \dBulk \cup \dCell$, as shown in Figure \ref{fig_02}. The interface $\Crown{}$ has some thickness $\ell > 0$ that is supposed to be small compared to $h_{\cell}$ the diameter of $\cell$.
From a geometrical standpoint, the core par of the element $\Bulk{}$ is an homotethy of $\cell$ by some ratio inferior to $1$.
%
% 
% 
\begin{figure}[H]
    \centering
    \includegraphics[width=14.cm]{img/hu_washizu.png}
    \caption{schematic representation of the composite region}
    \label{fig_02}
\end{figure}
%
%
%

\paragraph{Element behaviour}

The core of the element $\Bulk{}$ is made out of the same material that composes $\Omega$ and behaves according to the free energy potential $\mecPotential{}_{\bodyLag{}}$. The interface $\Crown{}$ is made out of a linear elastic-like material of Young modulus $\beta (\ell / h_{\cell})$ with a zero Poisson ratio and its behavior is defined by the free energy potential $\mecPotential{}_{\Crown{}}$ such that
%
%
%
\begin{equation}
    \label{eq_0009}
        \mecPotential{}_{\Crown} = \frac{1}{2} \beta \frac{\ell}{h_{\cell}} \nabla \tensori{u}{}_{\Crown} : \nabla \tensori{u}{}_{\Crown}
\end{equation}
%
%
%
where the dimensionless ratio $\ell / h_{\cell}$ balances the accumulated energy with the size of the domain $\cell$.

\paragraph{Element loading}

The core $\Bulk$ is subjected to the volumetric loading $\loadLag{}$, and to the contact load applied by the interface $\Crown{}$ onto $\dBulk{}$. By continuity of the traction force, the same opposite contact load acts on $\Crown{}$. The interface $\Crown{}$ is also subjected to some contact load $\neumannCellLoad{}$ acting on $\dCell{}$, that accounts for the action of the rest of the solid $\bodyLag{}$ onto $\cell$.

\paragraph{Discplacement, displacement gradient and stress fields}

Let note $\tensori{u}{}_{\Bulk}$ the displacement field, $\tensorii{G}{}_{\Bulk}$ the displacement gradient field and $\tensorii{P}{}_{\Bulk}$ the stress field in $\Bulk{}$. Similarly, let $\tensori{u}{}_{\Crown{}}$ the displacement field, $\tensorii{G}{}_{\Crown}$ the displacement gradient field and $\tensorii{P}{}_{\Crown}$ the stress field in $\Crown{}$.
The displacement of the boundary $\dCell{}$ is denoted $\tensori{u}{}_{\dCell{}}$.
By continuity of the displacement field between $\Bulk{}$ and $\dCell$,  the displacement $\tensori{u}{}_{\Crown{}}$ verifies
%
% 
% 
\begin{subequations}
    \label{eq_conformity}
        \begin{alignat}{2}
        \tensori{u}{}_{\Crown} \vert_{\dBulk} & = \tensori{u}{}_{\Bulk} \vert_{\dBulk}
        \label{eq_conformity:eq1}
        \\
        \tensori{u}{}_{\Crown} \vert_{\dCell} & = \tensori{u}{}_{\dCell}
        \label{eq_conformity:eq2}
    \end{alignat}
\end{subequations}

\paragraph{Hu-Washizu Lagrangian of the element}

By combining both the Lagragian of the core $\Bulk{}$ and that of the interface $\Crown{}$, one obtains the total Lagragian $L_{\cell}^{HW}$ over the element such that
%
%
%
\begin{equation}
    \label{eq_hu_washizu_split}
    L_{\cell}^{HW}
    % (\tensori{u}{}_{\cell}, \tensorii{G}{}_{\cell}, \tensorii{P}{}_{\cell})
    =
    \int_{\Bulk} \mecPotential_{\bodyLag{}} + (\nabla \tensori{u}{}_{\Bulk} - \tensorii{G}{}_{\Bulk}) : \tensorii{P}{}_{\Bulk}
    +
    \int_{\Crown} \mecPotential_{\Crown{}} + (\nabla \tensori{u}{}_{\Crown} - \tensorii{G}{}_{\Crown}) : \tensorii{P}{}_{\Crown}
    -
    \int_{\Bulk} \loadLag \cdot \tensori{u}{}_{\Bulk}
    % -
    % \int_{\Crown} \loadLag \cdot \tensori{u}{}_{\Crown}
    -
    \int_{\neumannCell} \neumannCellLoad \cdot \tensori{u}{}_{\dCell}
\end{equation}

\subsection{Hypotheses}
\label{sec_assumtions}

% The behavior and the kinematics having been described,
% Let make a number of assumptions on the expression of the fields of unknowns, by exploiting the fact that the core is of negligible volume compared to the interface.
Since the interface is of negligible volume compared to that of the core, let make some assumptions on the displacement and the stress in the interface.

\paragraph{Displacement in the interface}

The displacement in the interface $\Crown$ is assumed to be linear with respect to $\tensori{n}$, such that
its gradient is homogeneous in $\Crown{}$ along $\tensori{n}$
%
% 
% 
% \begin{equation}
%     \label{eq_crown_displacement}
%     \tensori{u}{}_{\Crown} (\tensori{x})
%     =
%     \frac{\tensori{u}{}_{\dCell}(\tensori{m}{}_{\dCell})
%     -
%     \tensori{u}{}_{\Bulk} \vert_{\dBulk} (\tensori{m}{}_{\dBulk})}{\ell} \otimes \tensori{n} \cdot (\tensori{x} - \tensori{m}{}_{\dBulk})
%     +
%     \tensori{u}{}_{\Bulk} \vert_{\dBulk}(\tensori{m}{}_{\dBulk})
% \end{equation}
\begin{equation}
    \label{eq_crown_displacement}
    \nabla
    \tensori{u}{}_{\Crown}
    =
    \frac{\tensori{u}{}_{\dCell}
    -
    \tensori{u}{}_{\Bulk} \vert_{\dBulk} }{\ell} \otimes \tensori{n}
\end{equation}
% 
% 
%
That is, the displacement of the interface $\Crown{}$ linearly bridges that of the boundary $\dCell{}$ to that of the bulk $\Bulk{}$.

\paragraph{Stress in the interface}

Furthermore, let assume that $\tensorii{P}{}_{\Crown}$ is constant along the direction $\tensori{n}{}$ in $\Crown{}$. By continuity of the traction force across $\dBulk$, the following equality holds true
%
% 
% 
\begin{equation}
    \label{eq_continuity_traction_force}
    \begin{aligned}
        (\tensorii{P}{}_{\Crown} - \tensorii{P}{}_{\Bulk} \vert_{\dBulk{}}) \cdot \tensori{n}{} =  0
        &&
        \text{in}
        &&
        \Crown{}
    \end{aligned}
\end{equation}

\subsection{Deriving the formulation of Hybrid discontinuous methods from the Hu-Washizu functional on the element}

Using the hypotheses stated Section \ref{sec_assumtions} on the displacement field and the stress field in $\Crown{}$,
one can write \eqref{eq_hu_washizu_split} as a term depending on the width of the interface $\ell$ and on the core and boundary unknowns only. The reader can refer to Section \ref{sec_appendix} for more details.
% one can writes \eqref{eq_hu_washizu_split} as the simplified Hu–Washizu Lagrangian

\paragraph{Simplified Hu–Washizu Lagrangian for a vanishing interface}

In particular, making the width of the interface $\ell \rightarrow 0$, such that $\Crown{}$ vanishes and the core part $\Bulk{}$ identifies to $\cell$, one obtains the simplified Hu–Washizu Lagrangian
% 
% 
%
\begin{equation}
    \label{eq_0015}
    \begin{aligned}
        L_{\cell}^{HW}
        = &
        \int_{\cell{}} \mecPotential{}_{\bodyLag{}} + (\nabla \tensori{u}{}_{\cell{}} - \tensorii{G}{}_{\cell{}}) : \tensorii{P}{}_{\cell}
        % \\
        % &
        + \int_{\dCell{}} (\tensori{u}{}_{\dCell} - \tensori{u}{}_{\cell} \vert_{\dCell}) \cdot \tensorii{P}{}_{\cell} \vert_{\dCell{}} \cdot \tensori{n}{}
        % \\
        % &
        + \int_{\dCell} \frac{\beta}{2 h_{\cell}} \lVert \tensori{u}{}_{\dCell{}} - \tensori{u}{}_{\cell{}} \vert_{\dCell{}} \rVert^2
        \\
        &
        -
        \int_{\cell} \loadLag{} \cdot \tensori{u}{}_{\cell{}}
        -
        \int_{\neumannCell{}} \neumannCellLoad{} \cdot \tensori{u}{}_{\dCell{}}
    \end{aligned}
\end{equation}
%
%
%
which fully defines the equilibrium of an element for discontinuous methods.

\paragraph{Hybridization of the primal unknown; the HDG and HHO methods}

Since the interface $\Crown{}$ has vanished by making $\ell \rightarrow 0$, both $\tensori{u}{}_{\cell} \vert_{\dCell{}}$ the trace of the displacement of the core part $\cell$ onto $\dCell{}$ and the displacement of the boundary $\tensori{u}{}_{\dCell{}}$ coexist on $\dCell{}$. The displacement of the element $\cell$ is thus said to be \textit{hybrid}, and is denoted by the pair $(\tensori{u}{}_{\cell}, \tensori{u}{}_{\dCell})$.

% The displacement is discontinuous across $\dCell{}$ by considering the vanishing interface, that allows for the core part $\cell{}$ to move away from the boundary $\dCell$, thus introducing a possible displacement jump on $\dCell{}$.
% This assumption relates to the concept of hybridization of the displacement unknown, which is at the foundation of Hybrid Discontinuous Galerkin methods.
% The displacement of the element $\cell$ hence depends on the pair $(\tensori{u}_{\cell}, \tensori{u}_{\dCell})$, where the trace of the core unknown $\tensori{u}_{\cell} \vert_{\dCell{}}$ coexists with $\tensori{u}_{\dCell}$ on $\dCell{}$.

\paragraph{The special case of DG methods}

Replacing $\tensori{u}{}_{\dCell}$ by $\tensori{u}{}_{\cell'} \vert_{\dCell}$ for any neighboring cell $\cell'$ amounts to describe the framework of Discontinuous Galerkin methods, where only the core unknown $\tensori{u}{}_{\cell}$ is considered, and the displacement jump on $\dCell$ depends on $\tensori{u}{}_{\cell'} \vert_{\dCell}$ the trace of the displacement of neighboring cells instead.
% of that of an independent boundary shared by both $\cell$ and $\cell '$.

\paragraph{Conformal Galerkin formulation}

By strongly enforcing continuity of the displacement across $\dCell{}$ such that $\tensori{u}_{\cell} \vert_{\dCell} = \tensori{u}_{\dCell}$, one recovers the system defined in \eqref{eq_HW_0}, which defines the framework of conformal methods.

% The displacement is discontinuous across $\dCell{}$ by considering the vanishing interface, that allows for the core part $\cell{}$ to move away from the boundary $\dCell$, thus introducing a possible displacement jump on $\dCell{}$.
% This assumption relates to the concept of hybridization of the displacement unknown, which is at the foundation of Hybrid Discontinuous Galerkin methods.
% The displacement of the element $\cell$ hence depends on the pair $(\tensori{u}_{\cell}, \tensori{u}_{\dCell})$, where the trace of the core unknown $\tensori{u}_{\cell} \vert_{\dCell{}}$ coexists with $\tensori{u}_{\dCell}$ on $\dCell{}$.

\paragraph{Mixed problem for the discontinuous framework}

The Lagrangian \eqref{eq_0015} defines the mixed field functional to minimize, which amounts to solve the system

\begin{subequations}
    \label{eq_0017}
        \begin{alignat}{3}
            \frac{\partial L_{\cell}^{HW}}{\partial \tensori{u}{}_{\cell}} \delta \tensori{u}{}_{\cell}
            = & \int_{\cell} \tensorii{P}{}_{\cell} : \nabla \delta \tensori{u}{}_{\cell}
            -
            \int_{\cell} \tensori{f}{}_V \cdot \delta \tensori{u}{}_{\cell}
            -
            \int_{\dCell{}} \tensori{\theta}{}_{\dCell} \cdot \delta \tensori{u}{}_{\cell} \vert_{\dCell}
            &&
            \ \ \ \ \ \ \ \ 
            &&
            \forall \delta \tensori{u}{}_{\cell}
            % \in \virtualDisplacementSpaceCell
        \label{eq_0017:eq0}
        \\
            \frac{\partial L_{\cell}^{HW}}{\partial \tensori{u}{}_{\dCell}} \delta \tensori{u}{}_{\dCell}
            = &
            \int_{\neumannCell} (\tensori{\theta}{}_{\dCell} - \tensori{t}{}_{\neumannCell}) \cdot \delta \tensori{u}{}_{\dCell}
            &&
            \ \ \ \ \ \ \ \ 
            &&
            \forall \delta \tensori{u}{}_{\dCell}
            % \in \virtualDisplacementSpaceDCell
        \label{eq_0017:eq1}
        \\
            \frac{\partial L_{\cell}^{HW}}{\partial \tensorii{G}{}_{\cell}} \delta \tensorii{G}{}_{\cell}
            = &
            \int_{\cell} (\frac{\partial \mecPotential_{\bodyLag}}{\partial \tensorii{G}{}_{\cell}} - \tensorii{P}{}_{\cell}) : \delta \tensorii{G}{}_{\cell}
            &&
            \ \ \ \ \ \ \ \ 
            &&
            \forall \delta \tensorii{G}{}_{\cell}
            % \in \gradSpaceCell
        \label{eq_0017:eq2}
        \\
            \frac{\partial L_{\cell}^{HW}}{\partial \tensorii{P}{}_{\cell}} \delta \tensorii{P}{}_{\cell}
            = & \int_{\cell} (\nabla \tensori{u}{}_{\cell} - \tensorii{G}{}_{\cell} ) : \delta \tensorii{P}{}_{\cell}
            +
            \int_{\dCell} (\tensori{u}{}_{\dCell} - \tensori{u}{}_{\cell} \vert_{\dCell}) \cdot \delta \tensorii{P}{}_{\cell} \vert_{\dCell} \cdot \tensori{n}{}
            &&
            \ \ \ \ \ \ \ \ 
            &&
            \forall \delta \tensorii{P}{}_{\cell}
            % \in \stressSpaceCell
        \label{eq_0017:eq3}
    \end{alignat}
\end{subequations}
% 
% 
%
where we introduced the \textit{reconstructed traction force} $\tensori{\theta}{}_{\dCell} = \tensorii{P}{}_{\cell} \vert_{\dCell} \cdot \tensori{n}{} + (\beta / h_{\cell}) (\tensori{u}{}_{\dCell} - \tensori{u}{}_{\cell} \vert_{\dCell})$.
In particular, \eqref{eq_0017:eq0} is the expression of the principle of virtual works in $\cell$, where the \textit{reconstructed traction force} $\tensori{\theta}{}_{\dCell}$ replaces the usual expression $\tensorii{P}{}_{\cell} \cdot \tensori{n}{}$ in the external contribution. \eqref{eq_0017:eq1} denotes a supplementary equation to the usual continuous problem as described in \eqref{eq_hu_washizu_derivative_0}, to account for the continuity of the flux $\tensori{\theta}{}_{\dCell}$ across the cell boundary.
% This feature constitutes one of the key assets of non-conformal method; indeed, by defining a richer flux than in the usual continuous framework, that also depends on the displacement jump, one allows for the latter to act as a Lagrange multiplier in order to fulfill the flux continuity requirement on $\dCell$.
% La continuité du flux aux interfaces is indeed the tradeoff for having loosened la continuité du déplacement aux interfaces.
% Stability of the problem is then recovered through the interface behaviour that penalizes displacement jumps in a weak sense.
% \eqref{eq_0017:eq2} defines the stress-behaviour law relation, and \eqref{eq_0017:eq3} defines a gradient field reconstruction based on a linear problem, whose second term depends on both a body and a boundary term.
\eqref{eq_0017:eq2} accounts for the constitutive equation in a weak sense, and \eqref{eq_0017:eq3} defines the equation of an enhanced gradient field, that does not reduce to the projection of $\nabla \tensori{u}{}_{\cell}$ as in \eqref{eq_hu_washizu_derivative_0:eq3}, since it is enriched by a boundary component that depends on the displacement jump, which is at the origin of the robustness of non-conformal methods to volumetric locking (see Section \ref{sec_appendix}).
%
%
%
%
% Indeed, defining $\tensori{I}{}(\tensori{v}{})$ the interpolation operator

\subsection{Problem in primal form}
\label{sec_hdg_element_equilibrium}

\paragraph{Reconstructed gradient}

Since minimization of \eqref{eq_0017:eq3} defines a linear problem with any displacement pair $(\tensori{v}{}_{\cell}, \tensori{v}{}_{\dCell})$, one can eliminate \eqref{eq_0017:eq3} from the system \eqref{eq_0017}. The resulting equation defines the so-called \textit{reconstructed gradient} $\tensorii{G}{}_{\cell}(\tensori{v}{}_{\cell}, \tensori{v}{}_{\dCell})$ associated with any displacement pair $(\tensori{v}{}_{\cell}, \tensori{v}{}_{\dCell})$, that solves
%
%
%
\begin{equation}
    \label{eq_grad}
    \begin{aligned}
        \int_{\cell} \tensorii{G}{}_{\cell}(\tensori{v}{}_{\cell}, \tensori{v}{}_{\dCell}) : \tensorii{\tau}{}_{\cell}
        =
        \int_{\cell}  \nabla \tensori{v}{}_{\cell} : \tensorii{\tau}{}_{\cell}
        +
        \int_{\dCell} (\tensori{v}{}_{\dCell} - \tensori{v}{}_{\cell} \vert_{\dCell}) \cdot \tensorii{\tau}{}_{\cell} \vert_{\dCell} \cdot \tensori{n}{}
        &&
        \forall \tensorii{\tau}{}_{\cell} \in \stressSpaceCell
    \end{aligned}
\end{equation}

\paragraph{Stress tensor}

Likewise, one eliminates \eqref{eq_0017:eq2} from \eqref{eq_0017}. Assuming that the space of kinematically admissible stress fields is included in that of kinematically admissible displacement gradient fields, one considers the equality in a strong sense
%
%
%
% \begin{equation}
%     \label{eq_stress}
%     \begin{aligned}
%         \int_{\cell} \tensorii{P}{}_{\cell} : \tensorii{\gamma}{}_{\cell}
%         =
%         \int_{\cell} \frac{\partial \mecPotential_{\bodyLag}}{\partial \tensorii{G}{}_{\cell}}  : \tensorii{\gamma}{}_{\cell}
%         &&
%         \forall \tensorii{\gamma}{}_{\cell} \in \gradSpaceCell
%     \end{aligned}
% \end{equation}
%
%
%
\begin{equation}
    \label{eq_stress}
    \begin{aligned}
        \tensorii{P}{}_{\cell} = \frac{\partial \mecPotential_{\bodyLag}}{\partial \tensorii{G}{}_{\cell}}
    \end{aligned}
\end{equation}

\paragraph{Total Lagrangian for the problem in primal form}

By elimination of both \eqref{eq_0017:eq2} and \eqref{eq_0017:eq3} from \eqref{eq_0017}, the functional for the problem in primal form \eqref{eq_simple} arises from \eqref{eq_0015}
%
%
%
\begin{equation}
    \label{eq_simple}
    \begin{aligned}
        L_{\cell}^{VW}
        = &
        \int_{\cell{}} \mecPotential{}_{\bodyLag{}}
        % \\
        % &
        % + \int_{\dCell{}} (\tensori{u}{}_{\dCell} - \tensori{u}{}_{\cell} \vert_{\dCell}) \cdot \tensorii{P}{}_{\cell} \vert_{\dCell{}} \cdot \tensori{n}{}
        % \\
        % &
        + \int_{\dCell} \frac{\beta}{2 h_{\cell}} \lVert \tensori{u}{}_{\dCell{}} - \tensori{u}{}_{\cell{}} \vert_{\dCell{}} \rVert^2
        % \\
        % &
        -
        \int_{\cell} \loadLag{} \cdot \tensori{u}{}_{\cell{}}
        -
        \int_{\neumannCell{}} \neumannCellLoad{} \cdot \tensori{u}{}_{\dCell{}}
    \end{aligned}
\end{equation}

\paragraph{Principle of virtual works for HDG methods}
%
%
%
% The problem in primal form amounts to find the displacement pair $(\tensori{u}{}_{\cell}, \tensori{u}{}_{\dCell}) \in \hybridDisplacementSpaceCell$ verifying $\tensori{u}{}_{\dCell} = \dirichletLag$ on $\dirichletCell$,
% such that for all kinematically admissible displacements pairs $(\delta \tensori{u}{}_{T}, \delta \tensori{u}{}_{\partial T}) \in \virtualHybridDisplacementSpaceCell$, the functional \eqref{eq_simple} is minimal, \textit{i.e.} such that
Minimization of the Lagrangian \eqref{eq_simple} amounts to find the displacement pair $(\tensori{u}{}_{\cell}, \tensori{u}{}_{\dCell})$ that solves
%
%
%
\begin{equation}
    \label{eq_0018}
    \begin{aligned}
        % d L_{\cell}^{\text{HW}}
        % = &
        % \frac{\partial L_{\cell}}{\partial \tensori{u}{}_{\cell}} \delta \tensori{u}{}_{\cell}
        % +
        % \frac{\partial L_{\cell}}{\partial \tensori{u}{}_{\dCell}} \delta \tensori{u}{}_{\dCell}
        % =
        \delta L_{\cell, \text{int}}^{VW}
        (
            (\tensori{u}{}_{\cell}, \tensori{u}{}_{\dCell}),
            (\delta \tensori{u}{}_{\cell}, \delta \tensori{u}{}_{\dCell})
        )
        -
        \delta L_{\cell, \text{ext}}^{VW}
        (\delta \tensori{u}{}_{\cell}, \delta \tensori{u}{}_{\dCell})
        =
        0
        &&
        &&
        \forall (\delta \tensori{u}{}_{\cell}, \delta \tensori{u}{}_{\dCell})
        % \\
        % = & \delta L_{\cell}^{\text{int}} + \delta L_{\cell}^{\text{ext}}
        % \\
        % = & 
        % \int_{T}
        % \tensorii{P}{}_{\cell}(\tensorii{G}{}_{\cell}(\tensori{u}{}_{\cell}, \tensori{u}{}_{\dCell}))
        % :
        % \tensorii{G}{}_{\cell}(\delta \tensori{u}{}_{\cell}, \delta \tensori{u}{}_{\dCell})
        % % \frac{\partial \mecPotential_{\bodyLag}}{\partial \tensorii{G}{}_T} : \delta \tensorii{G}{}_{T}
        % +
        % \int_{\partial T} (\beta / h_T)
        % (\tensori{u}{}_{\partial T} - \tensori{u}{}_{T} \vert_{\partial T})
        % % \tensori{Z}{}_{\dCell{}}
        % \cdot
        % (\delta \tensori{u}{}_{\partial T} - \delta \tensori{u}{}_{T} \vert_{\partial T})
        % % \delta \tensori{Z}{}_{\dCell{}}
        % \\
        % &
        % -
        % \int_{\partial T} \tensori{t}{}_N \cdot \delta \tensori{u}{}_{\partial T}
        % -
        % \int_{T} \tensori{f}{}_V \cdot \delta \tensori{u}{}_{T}
        % =
        % 0
    \end{aligned}
\end{equation}
%
%
%
with
%
%
%
\begin{subequations}
    \label{eq_0nonamemee}
        \begin{alignat}{3}
            \delta L_{\cell, \text{int}}^{VW} & = 
            \int_{T}
            \tensorii{P}{}_{\cell}(\tensorii{G}{}_{\cell}(\tensori{u}{}_{\cell}, \tensori{u}{}_{\dCell}))
            :
            \tensorii{G}{}_{\cell}(\delta \tensori{u}{}_{\cell}, \delta \tensori{u}{}_{\dCell})
            % \frac{\partial \mecPotential_{\bodyLag}}{\partial \tensorii{G}{}_T} : \delta \tensorii{G}{}_{T}
            +
            \int_{\dCell} (\beta / h_{\cell})
            % (\tensori{u}{}_{\dCell} - \tensori{u}{}_{\cell} \vert_{\dCell})
            % \tensori{Z}{}_{\dCell{}}
            \tensori{Z}{}_{\dCell}(\tensori{u}{}_{\cell}, \tensori{u}{}_{\dCell})
            \cdot
            % (\delta \tensori{u}{}_{\dCell} - \delta \tensori{u}{}_{\cell} \vert_{\dCell{}})
            % \delta \tensori{Z}{}_{\dCell{}}
            \tensori{Z}{}_{\dCell}(\delta \tensori{u}{}_{\cell}, \delta \tensori{u}{}_{\dCell})
            \\
            \delta L_{\cell, \text{ext}}^{VW} & = 
            \int_{\neumannCell} \neumannCellLoad{} \cdot \delta \tensori{u}{}_{\dCell{}}
            +
            \int_{T} \loadLag \cdot \delta \tensori{u}{}_{\cell}
    \end{alignat}
\end{subequations}
%
%
%
where we introduced the jump function $\tensori{Z}{}_{\dCell}$ such that
%
%
%
\begin{equation}
    \begin{aligned}
        \tensori{Z}{}_{\dCell}(\tensori{v}{}_{\cell}, \tensori{v}{}_{\dCell}) = \tensori{v}{}_{\dCell} - \tensori{v}{}_{\cell} \vert_{\dCell}
        &&
        \forall (\tensori{v}{}_{\cell}, \tensori{v}{}_{\dCell}) \in \hybridDisplacementSpaceCell
    \end{aligned}
\end{equation}
%
%
%
In particular, one can readliy see the resemblance of \eqref{eq_0nonamemee} with
\eqref{eq_virtual_works_0},
% the ususal formulation of the principle of virtual works
where the so called \textit{reconstructed gradient} $\tensorii{G}{}_{\cell}(\tensori{u}{}_{\cell}, \tensori{u}{}_{\dCell})$ plays the role of the usual displacement Lagrangian gradient $\nabla \tensori{u}{}_{\cell}$, and where an additional \textit{stabilization term} corresponding to a traction energy on the boundary has been added to account for the penalization of the displacement jump on $\dCell$ through $\tensori{Z}{}_{\dCell}$ (or, equivalently, to account for the infinitésimale interface that lays between the bulk domain and its boundary).
Equations \eqref{eq_simple}, \eqref{eq_grad} and \eqref{eq_stress} define the mechanical problem to solve at the cell level for Hybrid Discontinuous Galerkin methods, and \eqref{eq_0018} describes the weak form of these equations.

\subsection{Small strain hypothesis extension}

% La formulation proposée en grandes déformations permet également un passage naturel au cadre des petites déformations. Dans ce contexte, étant donné que le gradient de la transformation $\tensorii{F}{}_{\cell}$ est supposé petit devant $\tensorii{1}$, on cherche le champ de déformation infinitésimale $\tensorii{\varepsilon}{}_{\cell}$ comme la formulation faible de $\nabla^s \tensori{u}{}_{\cell}$ plutot que le gradient du champ de déplacement $\tensorii{G}{}_{\cell}$. le tenseur des contraintes $\tensorii{P}{}_{\cell}$ est alors identifié à $\tensorii{\sigma}{}_{\cell}$, de sorte que le problème \eqref{eq_0015} devient
The proposed large deformation formulation also allows a natural transition to the small deformation framework. In this context, since the gradient of the transformation $\tensorii{F}{}_{\cell}$ is assumed to be small compared to $\tensorii{1}$, we seek the infinitesimal deformation field $\tensorii{\varepsilon}_{\cell}$ as the weak formulation of $\nabla^s \tensori{u}_{\cell}$ rather than the gradient of the displacement field $\tensorii{G}{}_{\cell}$. The stress tensor $\tensorii{P}{}_{\cell}$ is then identified with $\tensorii{\sigma}{}_{\cell}$, so that the problem \eqref{eq_0015} becomes
%
%
%
\begin{equation}
    \label{eq_small_defs}
    \begin{aligned}
        L_{\cell}^{HW}
        = &
        \int_{\cell{}} \mecPotential{}_{\bodyLag{}} + (\nabla^s \tensori{u}{}_{\cell{}} - \tensorii{\varepsilon}{}_{\cell{}}) : \tensorii{\sigma}{}_{\cell}
        % \\
        % &
        + \int_{\dCell{}} (\tensori{u}{}_{\dCell} - \tensori{u}{}_{\cell} \vert_{\dCell}) \cdot \tensorii{\sigma}{}_{\cell} \vert_{\dCell{}} \cdot \tensori{n}{}
        % \\
        % &
        + \int_{\dCell} \frac{\beta}{2 h_{\cell}} \lVert \tensori{u}{}_{\dCell{}} - \tensori{u}{}_{\cell{}} \vert_{\dCell{}} \rVert^2
        \\
        &
        -
        \int_{\cell} \loadLag{} \cdot \tensori{u}{}_{\cell{}}
        -
        \int_{\neumannCell{}} \neumannCellLoad{} \cdot \tensori{u}{}_{\dCell{}}
    \end{aligned}
\end{equation}
%
%
%
% En poursuivant le même développement que précédemment, l'énargie à minimiser est donnée par l'équation \ref{eq_simple} comme dans le cadre des grandes déformations. En revanche,l'équation du gradient reconstruit \ref{eq_grad} devient
Continuing the same development as above, the energy to be minimized is given by equation \ref{eq_simple} as in the large deformation framework. On the other hand, the reconstructed gradient equation \ref{eq_grad} becomes
%
%
%
% \begin{equation}
%     \label{eq_simple_ss}
%     \begin{aligned}
%         L_{\cell}^{VW}
%         = &
%         \int_{\cell{}} \mecPotential{}_{\bodyLag{}}
%         % \\
%         % &
%         % + \int_{\dCell{}} (\tensori{u}{}_{\dCell} - \tensori{u}{}_{\cell} \vert_{\dCell}) \cdot \tensorii{P}{}_{\cell} \vert_{\dCell{}} \cdot \tensori{n}{}
%         % \\
%         % &
%         + \int_{\dCell} \frac{\beta}{2 h_{\cell}} \lVert \tensori{u}{}_{\dCell{}} - \tensori{u}{}_{\cell{}} \vert_{\dCell{}} \rVert^2
%         % \\
%         % &
%         -
%         \int_{\cell} \loadLag{} \cdot \tensori{u}{}_{\cell{}}
%         -
%         \int_{\neumannCell{}} \neumannCellLoad{} \cdot \tensori{u}{}_{\dCell{}}
%     \end{aligned}
% \end{equation}
%
%
%
% where \eqref{eq_0017:eq3} results in the definition of the \textit{reconstructed gradient} $\tensorii{G}{}_{\cell}(\tensori{v}{}_{\cell}, \tensori{v}{}_{\dCell})$ associated with any displacement pair $(\tensori{v}{}_{\cell}, \tensori{v}{}_{\dCell}) \in \hybridDisplacementSpaceCell$ that solves
% where \eqref{eq_0017:eq2} and \eqref{eq_0017:eq3} are taken to be zero such that the reconstructed gradient $\tensorii{G}{}_{\cell}(\tensori{v}{}_{\cell}, \tensori{v}{}_{\dCell})$ associated with any displacement pair $(\tensori{v}{}_{\cell}, \tensori{v}{}_{\dCell}) \in \displacementSpaceCell \times \displacementSpaceDCell$ explicitly solves
%
%
%
\begin{equation}
    \label{eq_grad_ss}
    \begin{aligned}
        \int_{\cell} \tensorii{\varepsilon}{}_{\cell}(\tensori{v}{}_{\cell}, \tensori{v}{}_{\dCell}) : \tensorii{\tau}{}_{\cell}
        =
        \int_{\cell}  \nabla^s \tensori{v}{}_{\cell} : \tensorii{\tau}{}_{\cell}
        +
        \int_{\dCell} (\tensori{v}{}_{\dCell} - \tensori{v}{}_{\cell} \vert_{\dCell}) \cdot \tensorii{\tau}{}_{\cell} \vert_{\dCell} \cdot \tensori{n}{}
        &&
        \forall \tensorii{\tau}{}_{\cell}
        % \in \stressSpaceCell
    \end{aligned}
\end{equation}
%
%
%
% En particulier, les deformations $\tensorii{\varepsilon}{}_{\cell}$ étant symétriques, tout comme la contrainte $\tensorii{\sigma}{}_{\cell}$, on cherche donc ces grandeurs dans l'espace des déformations $\gradSpaceCell$ et contraintes $\stressSpaceCell$ statiquement admissbles et symétriques. L'expression de la contrainte en fonction de la déformation de cellule est alors donnée par
In particular, the deformations $\tensorii{\varepsilon}{}_{\cell}$ being symmetrical, as well as the stress $\tensorii{\sigma}{}_{\cell}$, we thus seek these quantities in the space of statically admissible and symmetrical deformations and stresses. The expression of the stress as a function of the cell deformation is then given by
%
%
%
% \begin{equation}
%     \label{eq_stress_ss}
%     \begin{aligned}
%         \int_{\cell} \tensorii{\sigma}{}_{\cell} : \tensorii{\gamma}{}_{\cell}
%         =
%         \int_{\cell} \frac{\partial \mecPotential_{\bodyLag}}{\partial \tensorii{\varepsilon}{}_{\cell}}  : \tensorii{\gamma}{}_{\cell}
%         &&
%         \forall \tensorii{\gamma}{}_{\cell} \in \gradSpaceCell
%     \end{aligned}
% \end{equation}
%
%
%
\begin{equation}
    \label{eq_stress_ss}
    \begin{aligned}
        \tensorii{\sigma}{}_{\cell} = \frac{\partial \mecPotential_{\bodyLag}}{\partial \tensorii{\varepsilon}{}_{\cell}}
    \end{aligned}
\end{equation}
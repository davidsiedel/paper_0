\section{Discretization}

% Since the displacement unknown is hybrid, we introduce the \textit{skeleton} of the mesh, that bears boundary unknowns. We then specify the problem to solve at 
In this section, we specify the nature of the mesh, and introduce the so-called \textit{skeleton} of the mesh, that bears boundary displacement unknowns.
We then devise the problem to solve at the structural level, from the equilibrium of an element as described in Section \ref{sec_hdg_element_equilibrium}.
Approximation spaces for unknowns of the global problem are then described, which leads to several choices in terms of definition of the stabilization. Depending on such a choice, one recovers either the HDG method, or the HHO one. Finally, we give the expression of the global problem in discrete form.

\subsection{Spatial discretization}

\paragraph{Faces and skeleton of the mesh}

The boundary $\dCell{}$ of each element is decomposed in faces, such that a face $F$ is a subset of $\bodyLag$, and either there are two cells $\cell$ and $\cell'$ such that $F = \dCell \cap \dCell'$ ($F$ is then an interior face), or there is a single cell $\cell$ such that $F = \dCell \cap \partial \Omega$ ($F$ is then an exterior face).
For any cell $\cell$, let $\mathcal{F}(\cell) = \{ F \in \dHybridMesh \ \vert \ F \subset \dCell \}$ the set of faces composing the boundary of $\cell$.
Let finally $\dHybridMesh(\bodyLag) = \{ F_i \subset \bodyLag \ \vert \ 1 \leq i \leq N_{F} \}$ the skeleton of the mesh, collecting all element faces $F_i$ in the mesh, where $N_{F}$ denotes the number of faces. The set of faces subjected to Neumann boundary conditions is denoted $\dHybridMesh{}_{N}^e(\bodyLag)$, and $\dHybridMesh{}_{D}^e(\bodyLag)$ denotes that subjected to Dirichlet boundary conditions.

\paragraph{Mesh description}

Likewise, one defines the collection of all cells in the mesh as
$\HybridMesh(\bodyLag) = \{ \matI \subset \bodyLag \ \vert \ 1 \leq i \leq N_{\cell} \}$, where $N_T$ denotes the total number of cells.
The composition of both $\mathcal{T}(\bodyLag)$ and $\dHybridMesh{}(\bodyLag)$ forms the hybrid mesh
% $\overline{\mathcal{T}}({\bodyLag}) = \{T \subset \bodyLag, F \subset \bodyLag \ \vert \ T \in \mathcal{T}(\bodyLag) \ \vert \ F \in \mathcal{F}(\bodyLag) \}$.
$\HybridMeshWhole({\bodyLag}) = \{ \mathcal{T}(\bodyLag), \mathcal{F}(\bodyLag) \}$.

\subsection{Global continuous problem}

\paragraph{Global unknown}

% Contrary to the standard finite element method that consists in seeking a global solution in a regular enough space over the whole mesh, we consider here a much broader space that consists in $\displacementSpaceHybridMesh = \prod_{\cell \in \HybridMesh(\bodyLag)} \displacementSpaceCell$ the collection of all regular enough displacements element-wise.
% Similarly, we consider $\displacementSpaceDHybridMesh = \prod_{F \in \dHybridMesh(\bodyLag)} V(F)$ the space of all regular enough displacements face-wise for the skeleton unknown, such that the global solution space $\hybridDisplacementSpaceHybridMesh = \displacementSpaceHybridMesh \times \displacementSpaceDHybridMesh$ for the whole problem is simply the assembly of all element and face spaces in the mesh.

Let the global unknown $(\tensori{v}{}_{\HybridMesh}, \tensori{v}{}_{\dHybridMesh})$ a displacement pair such that for each $\cell \in \HybridMesh(\bodyLag), \tensori{v}{}_{\HybridMesh} = \tensori{v}{}_{\cell}$ in $\cell$ and for each $F \in \dHybridMesh(\bodyLag), \tensori{v}{}_{\dHybridMesh} = \tensori{v}{}_{F}$ on $F$, where $\tensori{v}{}_{\cell}$ and $\tensori{v}{}_{F}$ denote a cell and a face displacement field respectively.

% \newcommand\virtualDisplacementSpaceHybridMesh{U_0(\mathcal{T})}
% \newcommand\virtualDisplacementSpaceDHybridMesh{V_0(\mathcal{F})}
% \newcommand\virtualHybridDisplacementSpaceHybridMesh{U_0(\bar{\mathcal{T}})}
% The global unknown is then sought in the space $\displacementSpaceHybridMesh \times \displacementSpaceDHybridMesh$
% %
% %
% %
% \begin{equation}
%     \label{eq_space_def}
%     \begin{aligned}
%         \displacementSpaceHybridMesh = \prod_{\cell \in \HybridMesh(\bodyLag)} \displacementSpaceCell
%         &&
%         \text{and}
%         &&
%         \displacementSpaceDHybridMesh = \prod_{F \in \dHybridMesh(\bodyLag)} V(F)
%     \end{aligned}
% \end{equation}


\paragraph{Global weak form}


% , where both cells and faces are considered as part of the support for defining
The weak form of the global mechanical problem in $\bodyLag$ reads : find the global displacement unknown pair $(\tensori{u}{}_{\HybridMesh}, \tensori{u}{}_{\dHybridMesh})$ verifying $\tensori{u}{}_{\dHybridMesh} \vert_{\dirichletBoundaryLag} = \dirichletLag$ on $\dirichletBoundaryLag$ such that
$\forall (\delta \tensori{u}{}_{\HybridMesh}, \delta \tensori{u}{}_{\dHybridMesh})$
%
%
%
\begin{equation}
    \label{eq_0018kdk}
    \begin{aligned}
        \delta L_{\HybridMesh, \text{int}}^{VW} - \delta L_{\HybridMesh, \text{ext}}^{HW}
        =
        0
    \end{aligned}
\end{equation}
%
%
%
with
%
%
%
\begin{subequations}
    \label{eq_0nonamemeerg}
        \begin{alignat}{3}
            \delta L_{\HybridMesh, \text{int}}^{VW} & = 
            \sum_{\cell \in \HybridMesh(\bodyLag)}
            \int_{\cell}
            \tensorii{P}{}_{\cell}(\tensorii{G}{}_{\cell}(\tensori{u}{}_{\cell}, \tensori{u}{}_{\dCell}))
            :
            \tensorii{G}{}_{\cell}(\delta \tensori{u}{}_{\cell}, \delta \tensori{u}{}_{\dCell})
            % \frac{\partial \mecPotential_{\bodyLag}}{\partial \tensorii{G}{}_\cell} : \delta \tensorii{G}{}_{\cell}
            +
            \int_{\dCell} (\beta / h_{\cell})
            % (\tensori{u}{}_{\dCell} - \tensori{u}{}_{\cell} \vert_{\dCell})
            % \tensori{Z}{}_{\dCell{}}
            \tensori{Z}{}_{\dCell}(\tensori{u}{}_{\cell}, \tensori{u}{}_{\dCell})
            \cdot
            % (\delta \tensori{u}{}_{\dCell} - \delta \tensori{u}{}_{\cell} \vert_{\dCell{}})
            % \delta \tensori{Z}{}_{\dCell{}}
            \tensori{Z}{}_{\dCell}(\delta \tensori{u}{}_{\cell}, \delta \tensori{u}{}_{\dCell})
            \\
            \delta L_{\HybridMesh, \text{ext}}^{HW} & = 
            \sum_{F \in \dHybridMesh{}_{N}^e(\bodyLag)}
            \int_{F} \neumannLag \cdot \delta \tensori{u}{}_{F}
            +
            \sum_{\cell \in \HybridMesh(\bodyLag)}
            \int_{\cell} \loadLag \cdot \delta \tensori{u}{}_{\cell}
    \end{alignat}
\end{subequations}
%
%
%
% where $\displacementSpaceHybridMesh$ (respectively $\displacementSpaceDHybridMesh$) denotes the space of all globally kinematically admissible cell (respectively face) displacement fields,
% and
where for each element $\cell \in \HybridMesh(\bodyLag)$, the boundary displacement field $\tensori{v}{}_{\dCell}$ is such that $\tensori{v}{}_{\dCell} = \tensori{v}{}_{F}$ on $F$ for every $F \in \mathcal{F}(\cell)$

% Contrary to the standard finite element method that consists in seeking a global solution in a regular enough space over the whole mesh, we consider here a much broader space that consists in the collection of all regular enough displacements element-wise, such that displacement jumps are actually possible across elements.
% Similarily, we consider the space of all regular enough displacements face-wise for the skeleton unknown, such that the global unknown space for the whole problem is simply the assembly of all element and face spaces in the mesh :
% %
% %
% %
% \begin{equation}
%     \label{eq_space_def}
%     \begin{aligned}
%         \displacementSpaceHybridMesh = \prod_{\cell \in \HybridMesh(\bodyLag)} \displacementSpaceCell
%         &&
%         \text{and}
%         &&
%         \displacementSpaceDHybridMesh = \prod_{F \in \dHybridMesh(\bodyLag)} V(F)
%     \end{aligned}
% \end{equation}
% %
% %
% %
% Similarily, for each element $\cell \in \mathcal{T}$, the displacement space of its boundary $\displacementSpaceDCell$ is the collection of the face displacement spaces to which it is connected such that $\displacementSpaceDCell = \prod_{F \in \mathcal{F}(\cell)} V(F)$.

\subsection{Functional discretization and stabilization}

\paragraph{Discrete functional space}

For each element $\cell \in \HybridMesh(\bodyLag)$, we denote $\discreteDisplacementSpaceCell$ the approximation displacement space in the cell, and $\discreteDisplacementSpaceDCell$ that on the boundary. Similarly, let $\discreteGradSpaceCell$ the space used to build the discrete reconstructed gradient and $\discreteStressSpaceCell$ that chosen for the discrete stress such that
%
%
%
\begin{equation*}
    \begin{aligned}
        \discreteDisplacementSpaceCell & = P^l(\cell, \mathbb{R}^{d})
        \\
        \discreteDisplacementSpaceDCell & = P^k(\dCell, \mathbb{R}^{d})
        \\
        \discreteGradSpaceCell & = P^k(\cell, \mathbb{R}^{d \times d})
        \\
        \discreteStressSpaceCell & = P^k(\cell, \mathbb{R}^{d \times d})
    \end{aligned}
\end{equation*}
%
%
%
where the cell displacement polynomial order $l$ might be chosen different from the face displacement order $k$ such that $k - 1 \leq l \leq k + 1$.
% The jump function $\tensori{Z}{}_{\dCell}$ can be tweaked in order to act on the convergence order of the approximated solution
% LES STABILIZATIONS SONT A LORIOGINE DE LORDRE DE CONV
% Since two polynomial orders are available to define the displacement approximation,

\paragraph{HDG stabilization}

Accounting for the possible different polynomial order between the cell and faces, one can specify a discrete jump function in a natural way such that it delivers the displacement difference point-wise for any displacement pair $(\tensori{v}{}_{\cell}^l, \tensori{v}{}_{\dCell}^k) \in \discreteHybridDisplacementSpaceCell$
%
%
%
\begin{equation}
    \begin{aligned}
        \tensori{Z}{}_{\dCell}^{HDG}(\tensori{v}{}_{\cell}^l, \tensori{v}{}_{\dCell}^k) = \Pi^k_{\dCell{}} (
            \tensori{v}{}_{\dCell}^k - \tensori{v}{}_{\cell}^l \vert_{\dCell}
        )
    \end{aligned}
\end{equation}
%
%
%
where $\discreteHybridDisplacementSpaceCell = \discreteDisplacementSpaceCell \times \discreteDisplacementSpaceDCell$ and $\Pi^k_{\dCell{}}$ denotes the orthogonal projector onto $\discreteDisplacementSpaceDCell$.
This straightforward discrete jump function is at the origin of Hybrid Discontinuous Galerkin methods, and grants a convergence of order $k$ in the energy norm.

\paragraph{HHO stabilization}

A richer discrete jump function $\tensori{Z}{}_{\dCell}^{HHO}$ providing a convergence of order $k + 1$ in the energy norm was introduced in \cite{di_pietro_discontinuous-skeletal_2015}, hence giving the Hybrid High Order method its name, such that
%
%
%
\begin{equation}
    \label{eq_hho_stabilization_vector}
    \begin{aligned}
        \tensori{Z}{}_{\dCell}^{HHO}(\tensori{v}{}_{\cell}^l, \tensori{v}{}_{\dCell}^k) = \Pi^k_{\dCell{}} (
            \tensori{v}{}_{\dCell}^k - \tensori{v}{}_{\cell}^l \vert_{\dCell}
            -
            (
                (\tensoro{I}{}_{\cell}^{k + 1} - \Pi_{\cell}^k) (
                    \tensori{w}{}_\cell^{k + 1}
                )
            ) \vert_{\dCell{}}
        )
    \end{aligned}
\end{equation}
%
%
%
where $\Pi_{\cell}^k$ is the projector onto $P^{k}(\cell, \mathbb{R}^{d})$, $\tensoro{I}{}_{\cell}^{k + 1}$ is the identity function in $\discretePotentialSpaceCell = P^{k + 1}(\cell, \mathbb{R}^{d})$.

\paragraph{Reconstructed higher order displacement}

The term $\tensori{w}{}_{\cell}^{k+1}$ in \eqref{eq_hho_stabilization_vector}
% $ \in \discretePotentialSpaceCell$
denotes a higher order discrete displacement in $\discretePotentialSpaceCell$ that solves for any displacement pair $(\tensori{v}{}_{\cell}^l, \tensori{v}{}_{\dCell}^k) \in \discreteHybridDisplacementSpaceCell$
%
%
%
\begin{subequations}
    \label{eq_potential}
        \begin{alignat}{3}
            \int_\cell \nabla \tensori{w}{}_{\cell}^{k+1} : \nabla \tensori{d}{}_{\cell}^{k+1}
            & =
            \int_\cell \nabla \tensori{v}{}_{\cell}^l : \nabla \tensori{d}{}_{\cell}^{k+1}
            +
            \int_{\dCell} (\tensori{v}{}_{\dCell}^k - \tensori{v}{}_{\cell}^l) \cdot \nabla \tensori{d}{}_{\cell}^{k+1} \cdot \tensori{n}{}
            \ \ \ \ \ \ \ \ 
            &&
            \forall \tensori{d}{}_{\cell}^{k+1} \in \discretePotentialSpaceCell
            \label{eq_potential:eq0}
            \\
            \int_\cell \tensori{w}{}_{\cell}^{k+1} & = \int_\cell \tensori{v}{}_{\cell}^{l}
            \label{eq_potential:eq1}
    \end{alignat}
\end{subequations}
%
%
%
%

\subsection{Global discrete problem}

\paragraph{Discrete global approximtion spaces}

% With obvious notations,
Let $\discreteDisplacementSpaceHybridMesh = \prod_{\cell \in \HybridMesh(\bodyLag)} \discreteDisplacementSpaceCell$ the global discrete cell displacement space.
Let $\discreteDisplacementSpaceDHybridMesh = \prod_{F \in \dHybridMesh(\bodyLag)} V^h(F)$ the global discrete face displacement space, and
$\discreteHybridDisplacementSpaceHybridMesh = \discreteDisplacementSpaceHybridMesh \times \discreteDisplacementSpaceDHybridMesh$ the global unknown approximation space.
%
%
%
% Similarly, let $\discreteVirtualDisplacementSpaceHybridMesh$ and $\discreteVirtualDisplacementSpaceDHybridMesh$ the respective discrete mesh and skeleton virtual displacement spaces, and
% $\discreteVirtualHybridDisplacementSpaceHybridMesh = \discreteVirtualDisplacementSpaceHybridMesh \times \discreteVirtualDisplacementSpaceDHybridMesh$ the discrete virtual global displacement space.
% Let $(\tensori{v}{}_{\HybridMesh}^l, \tensori{v}{}_{\dHybridMesh}^k) \in \discreteHybridDisplacementSpaceHybridMesh$ denote a global displacement pair such that $\forall \cell \in \HybridMesh(\bodyLag), \tensori{v}{}_{\HybridMesh}^l = \tensori{v}{}_{\cell}^l$ in $\cell$ and $\forall F \in \HybridMesh(\bodyLag), \tensori{v}{}_{\dHybridMesh}^k = \tensori{v}{}_{F}^k$ in $F$.

\paragraph{Discrete global problem}

The global problem in discrete form writes : find the pair $(\tensori{u}{}_{\HybridMesh}^l, \tensori{u}{}_{\dHybridMesh}^k) \in \discreteHybridDisplacementSpaceHybridMesh$ verifying $\tensori{u}{}_{\dHybridMesh}^k \vert_{\dirichletBoundaryLag} = \dirichletLag$ on $\dirichletBoundaryLag$ such that $\forall (\delta \tensori{u}{}_{\HybridMesh}^l, \delta \tensori{u}{}_{\dHybridMesh}^k)
% \in \discreteVirtualHybridDisplacementSpaceHybridMesh
$
%
%
%
\begin{equation}
    \label{eq_0018kdk}
    \begin{aligned}
        \delta L_{\HybridMesh, \text{int}}^{HHO} - \delta L_{\HybridMesh, \text{ext}}^{HHO}
        =
        0
    \end{aligned}
\end{equation}
%
%
%
with
%
%
%
\begin{subequations}
    \label{eq_0nonamemeergjj}
        \begin{alignat}{3}
            \delta L_{\HybridMesh, \text{int}}^{HHO} & = 
            \sum_{\cell \in \HybridMesh(\bodyLag)}
            \int_{\cell}
            \tensorii{P}{}_{\cell}^k(\tensorii{G}{}_{\cell}^k(\tensori{u}{}_{\cell}^l, \tensori{u}{}_{\dCell}^k))
            :
            \tensorii{G}{}_{\cell}^k(\delta \tensori{u}{}_{\cell}^l, \delta \tensori{u}{}_{\dCell}^k)
            % \frac{\partial \mecPotential_{\bodyLag}}{\partial \tensorii{G}{}_\cell} : \delta \tensorii{G}{}_{\cell}
            +
            \int_{\dCell} (\beta / h_{\cell})
            \tensori{Z}{}_{\dCell}^{HHO}(\tensori{u}{}_{\cell}^l, \tensori{u}{}_{\dCell}^k)
            % \tensori{Z}{}_{\dCell{}}
            \cdot
            \tensori{Z}{}_{\dCell}^{HHO}(\delta \tensori{u}{}_{\cell}^l, \delta \tensori{u}{}_{\dCell}^k)
            % \delta \tensori{Z}{}_{\dCell{}}
            \\
            \delta L_{\HybridMesh, \text{ext}}^{HHO} & = 
            \sum_{F \in \dHybridMesh{}_{N}^e(\bodyLag)}
            \int_{F} \neumannLag \cdot \delta \tensori{u}{}_{F}^k
            +
            \sum_{\cell \in \HybridMesh(\bodyLag)}
            \int_{\cell} \loadLag \cdot \delta \tensori{u}{}_{\cell}^l
    \end{alignat}
\end{subequations}
%
%
%
where the discrete reconstructed gradient $\tensorii{G}{}_{\cell}^k(\tensori{v}{}_{\cell}^l, \tensori{v}{}_{\dCell}^k) \in \discreteGradSpaceCell$ solves $\forall (\tensori{v}{}_{\cell}^l, \tensori{v}{}_{\dCell}^k) \in \discreteHybridDisplacementSpaceCell$
%
%
%
\begin{equation}
    \label{eq_discrete_grad}
    \begin{aligned}
        \int_{\cell} \tensorii{G}{}_{\cell}^k(\tensori{v}{}_{\cell}^l, \tensori{v}{}_{\dCell}^k) : \tensorii{\tau}{}_{\cell}^k
        =
        \int_{\cell}  \nabla \tensori{v}{}_{\cell}^l : \tensorii{\tau}{}_{\cell}^k
        +
        \int_{\dCell} (\tensori{v}{}_{\dCell}^k - \tensori{v}{}_{\cell}^l \vert_{\dCell}) \cdot \tensorii{\tau}{}_{\cell}^k \vert_{\dCell} \cdot \tensori{n}{}
        &&
        \forall \tensorii{\tau}{}_{\cell}^k \in \discreteStressSpaceCell
    \end{aligned}
\end{equation}
\label{sec_model_problem}

Let $d \in  \{1, 2, 3\}$ the euclidean dimension of the cartesian space $\mathbb{R}{}^{d}$. Let $\bodyEul \subset \mathbb{R}{}^{d}$ a solid body with boundary $\dBodyEul \subset \mathbb{R}{}^{d - 1}$, that deforms in the current configuration at some time $t > 0$ under the body forces $\loadEul$. It is subjected to a prescribed displacement $\dirichletEul$ on the Dirichlet boundary $\dirichletBodyEul$, and to a contact load $\neumannEul{}$ on the Neumann boundary $\neumannBodyEul$, such that $\dBodyEul = \dirichletBodyEul \cup \neumannBodyEul$ and $\dirichletBodyEul{} \cap \neumannBodyEul = \emptyset$.

The initial configuration of the body at time $t = 0$ (see Figure \ref{fig_setting}) is denoted $\bodyLag \subset \mathbb{R}{}^{d}$ with respective Dirichlet and Neumann boundaries $\dirichletBodyLag$ and $\neumannBodyLag$. It is subjected to body forces $\loadLag$, an imposed displacement $\dirichletLag$ on $\dirichletBodyLag$ and contact force $\neumannLag$ on $\neumannBodyLag$. The transformation mapping $\tensori{\Phi}$ takes a point $\tensori{x} \in \bodyLag$ from the initial configuration to $\tensori{x}{}_t \in \bodyEul$ in the current configuration.

Let $\cell \subset \bodyLag$ an arbitrary open subset of the solid body, with boundary $\dCell \subset \mathbb{R}^{d - 1}$
which is split into an eventual Dirichlet boundary $\dirichletCell \subset \dirichletBodyLag$ subjected to an imposed displacement $\dirichletLag$ if $\cell$ shares a boundary with $\dirichletBodyLag$ and into the Neumann Boundary $\neumannCell \subset \neumannBodyLag \cup \bodyLag$ with contact load $\neumannCellLoad$ such that :
%
% 
% 
\begin{equation}
    \label{eq_contact_force}
    \begin{aligned}
        \neumannCellLoad = 
        \left\{
            \begin{array}{ll}
                \tensori{t}{}_{\bodyLag \backslash \cell \rightarrow \cell} & \mbox{on } \neumannCell \cap \bodyLag \backslash \cell
                \\
                \neumannLag & \mbox{on } \neumannCell \cap \neumannBodyLag
            \end{array}
        \right.
    \end{aligned}
\end{equation}
% 
% 
%
with $\tensori{t}{}_{\bodyLag \backslash \cell \rightarrow \cell}$ the contact force applied by the surrounding part of the body $\bodyLag$ onto the subset $\cell$, and $\dirichletCell \cap \neumannCell = \emptyset$.
%
% 
% 
\begin{figure}[H]
    \centering
    \includegraphics[width=7.cm]{img/setting.png}
    \caption{schematic representation of the model problem}
    \label{fig_setting}
\end{figure}
%
% 
% 

Let $\tensori{\Phi}{}_{\cell}$ the restriction of $\tensori{\Phi}$ to ${\cell}$, and $\tensori{u}{}_{\cell} \in \displacementSpaceCell$ the displacement field in $\cell$ such that $\tensori{\Phi}{}_{\cell} = \tensori{I}{}_d + \tensori{u}{}_{\cell}{}$ with $\tensori{I}{}_d$ the identity function, where the notation $\displacementSpaceCell$ denotes the space of all kinematically admissible displacement fields in $\cell$.
% 
Let $\tensorii{G}{}_{\cell} \in \gradSpaceCell$ the displacement gradient field in $\cell$, with $\gradSpaceCell$ the space of all statically admissible displacement gradient fields in $\cell$,
and $\tensorii{F}{}_{\cell} = \nabla \tensori{\Phi}{}_{\cell} = \tensorii{1} + \tensorii{G}{}_{\cell}$ the transformation gradient, where $\nabla$ denotes the Lagrangian nabla operator.
%
Let $\mecPotential{}_{\cell} (\tensorii{F}{}_{\cell}, \internaleStateVariables)$ the mechanical energy potential in $\cell$ that depends on the transformation gradient $\tensorii{F}{}_{\cell}$ and possibly on a set of internal state variables $\internaleStateVariables$, where $\nabla$ denotes the Lagrangian nabla operator.
%
% Let $\tensorii{P}{}_{\cell} \in \stressSpaceCell$ the first Piola-Kirchoff stress tensor deriving from the expression of the mechanical energy potential, with $\stressSpaceCell$ the space of all statically admissible stress fields in $\cell$.
Let $\tensorii{P}{}_{\cell} \in \stressSpaceCell$ the first Piola-Kirchoff stress tensor depending on the derivative of mechanical energy potential with respect to $\tensorii{F}{}_{\cell}$ with
%
%
%
\begin{equation}
    \label{eq_stress_def}
    \begin{aligned}
        \frac{\partial \mecPotential{}_{\cell}}{\partial \tensorii{F}{}_{\cell}}
        =
        \frac{\partial \mecPotential{}_{\cell}}{\partial \tensorii{G}{}_{\cell}} 
        \frac{\partial \tensorii{G}{}_{\cell}}{\partial \tensorii{F}{}_{\cell}}
        =
        \frac{\partial \mecPotential{}_{\cell}}{\partial \tensorii{G}{}_{\cell}}
    \end{aligned}
\end{equation}
%
%
%
with $\stressSpaceCell$ the space of all statically admissible stress fields in $\cell$.
%
%
%
The equilibrium of the body $\cell$ is reached for the displacement gradient field $\tensorii{G}{}_{\cell} \in \gradSpaceCell$, the first Piola-Kirchoff stress field $\tensorii{P}{}_{\cell} \in \stressSpaceCell$ and the displacement field $\tensori{u}{}_{\cell} \in \displacementSpaceCell$ verifying $\tensori{u}{}_{\cell} \vert_{\dirichletCell} = \dirichletLag$ on $\dirichletCell$ minimizing the three field Hu–Washizu energy functional $J_{\cell}^{HW}$:
%
%
%
\begin{equation}
    \label{eq_hu_washizu}
        J_{\cell}^{HW}
        % (\tensori{u}{}_{\cell}, \tensorii{G}{}_{\cell}, \tensorii{P}{}_{\cell})
        =
        \int_{\cell} \mecPotential{}_{\cell} + (\nabla \tensori{u}{}_{\cell} - \tensorii{G}{}_{\cell}) : \tensorii{P}{}_{\cell}
        -
        \int_{\cell} \loadLag \cdot \tensori{u}{}_{\cell}
        -
        \int_{\neumannCell} \neumannCellLoad \cdot \tensori{u}{}_{\cell}
\end{equation}
%
%
%
Deriving \eqref{eq_hu_washizu} with respect to all variables of the problem yields the weak formulation of the problem :
%
% 
% 
\begin{subequations}
    \label{eq_hu_washizu_derivative}
        \begin{alignat}{3}
            \frac{\partial J_{\cell}^{HW}}{\partial \tensori{u}{}_{\cell}} \delta \tensori{u}{}_{\cell}
            = & \int_{\cell} \tensorii{P}{}_{\cell} : \nabla \delta \tensori{u}{}_{\cell}
            -
            \int_{\cell} \tensori{f}{}_V \cdot \delta \tensori{u}{}_{\cell}
            -
            \int_{\dCell} \tensori{t}{}_{\neumannCell} \cdot \delta \tensori{u}{}_{\cell} \vert_{\dCell}
            &&
            \ \ \ \ \ \ \ \ 
            &&
            \forall \delta \tensori{u}{}_{\cell}
            \in \displacementSpaceCell
        \label{eq_hu_washizu_derivative:eq0}
        \\
            \frac{\partial J_{\cell}^{HW}}{\partial \tensorii{G}{}_{\cell}} \delta \tensorii{G}{}_{\cell}
            = &
            \int_{\cell} (\frac{\partial \mecPotential_{\cell}}{\partial \tensorii{G}{}_{\cell}} - \tensorii{P}{}_{\cell}) : \delta \tensorii{G}{}_{\cell}
            &&
            \ \ \ \ \ \ \ \ 
            &&
            \forall \delta \tensorii{G}{}_{\cell}
            \in \gradSpaceCell
        \label{eq_hu_washizu_derivative:eq2}
        \\
            \frac{\partial J_{\cell}^{HW}}{\partial \tensorii{P}{}_{\cell}} \delta \tensorii{P}{}_{\cell}
            = & \int_{\cell} (\nabla \tensori{u}{}_{\cell} - \tensorii{G}{}_{\cell} ) : \delta \tensorii{P}{}_{\cell}
            &&
            \ \ \ \ \ \ \ \ 
            &&
            \forall \delta \tensorii{P}{}_{\cell}
            \in \stressSpaceCell
        \label{eq_hu_washizu_derivative:eq3}
    \end{alignat}
\end{subequations}
%
%
%
where $\cdot \ \vert_{\dCell}$ denotes the trace operator on $\dCell$.
Since the subset $\cell$ is arbitrary, \eqref{eq_hu_washizu_derivative} holds true in a distributional sense, and by applying the divergence theorem on \eqref{eq_hu_washizu_derivative:eq0}, one obtains the strong formulation of problem \eqref{eq_hu_washizu} :
%
% 
% 
\begin{subequations}
\label{eq_model_problem}
    \begin{alignat}{2}
    % \tensorii{F} - \nabla_{X} \tensori{u} & = \tensorii{1} \quad && \text{in } \Omega_{0} \label{eq_model_problem:eq1}
    \tensorii{G}{}_{\cell} - \nabla \tensori{u}{}_{\cell} & = 0 \quad
    &&
    \text{in } \cell
    \label{eq_model_problem:eq1}
    \\
    % \tensorii{P} - \frac{\partial \mecPotential}{\partial \tensorii{F}} & = 0 \quad && \text{in } \Omega_{0} \label{eq_model_problem:eq2}
    \tensorii{P}{}_{\cell} - \frac{\partial \mecPotential{}_{\cell}}{\partial \tensorii{G}{}_{\cell}} & = 0 \quad
    &&
    \text{in } \cell
    \label{eq_model_problem:eq2}
    \\
    \nabla_{X} \cdot \tensorii{P}{}_{\cell} + \loadLag & = 0 \quad
    &&
    \text{in } \cell
    \label{eq_model_problem:eq3}
    \\
    \tensori{u}{}_{\cell} \vert_{\dirichletCell} & = \dirichletLag \quad
    &&
    \text{on } \dirichletCell
    \label{eq_model_problem:eq4}
    \\
    \tensorii{P}{}_{\cell} \cdot \tensori{n} & = \neumannCellLoad \quad
    &&
    \text{on } \neumannCell
    \label{eq_model_problem:eq5}
\end{alignat}
\end{subequations}
%
% 
% 
where $\tensori{n}$ denotes the unit ouward normal vector on $\dCell$.
One readliy identifies \eqref{eq_model_problem:eq1} with the displacement strain relation, \eqref{eq_model_problem:eq2} with the constitutive equation, \eqref{eq_model_problem:eq3} with the conservation of the movment quantity, \eqref{eq_model_problem:eq5} with the traction force continuity and \eqref{eq_model_problem:eq4} with boundary conditions.
%
%
%
Considering now that $\tensorii{G}{}_{\cell}$ and $\tensorii{P}{}_{\cell}$ are not unknowns of the problem, \textit{i.e.} by explicitly elimintaing both \eqref{eq_hu_washizu_derivative:eq2} and \eqref{eq_hu_washizu_derivative:eq3} from \eqref{eq_hu_washizu_derivative}, the problem associated to \eqref{eq_hu_washizu} simplifies as : find the displacement field $\tensori{u}{}_{\cell} \in \displacementSpaceCell$ verifying $\tensori{u}{}_{\cell} \vert_{\dirichletCell} = \dirichletLag$ on $\dirichletCell$ that minimizes the energy functional $J_{\cell}^{VW}$:
%
%
%
\begin{equation}
    \label{eq_virtual_works}
    \begin{aligned}
        J_{\cell}^{VW}
        % (\tensori{u}{}_{\cell})
        =
        \int_{\cell} \mecPotential{}_{\cell}
        -
        \int_{\cell} \loadLag \cdot \tensori{u}{}_{\cell}
        -
        \int_{\neumannCell} \neumannCellLoad \cdot \tensori{u}{}_{\cell}
    \end{aligned}
\end{equation}
%
%
%
Deriving \eqref{eq_virtual_works} with respect to the primal unknown $\tensori{u}{}_{\cell}$ yields the weak form of the problem, which is the notorious principle of virtual work:
%
%
%
\begin{equation}
    \label{eq_virtual_works_1}
    \begin{aligned}
        % \frac{\partial J_{\cell}}{\partial \tensori{u}{}_{\cell}} \delta \tensori{u}{}_{\cell}
        d J_{\cell}^{VW} = \frac{\partial J_{\cell}^{VW}}{\partial \tensori{u}{}_{\cell}} \delta \tensori{u}{}_{\cell}
        & =
        \int_{\cell}
        % \frac{\partial \mecPotential{}_{\cell}}{\partial \nabla \tensori{u}{}_{\cell}} : \nabla \delta \tensori{u}{}_{\cell}
        \tensorii{P}{}_{\cell} : \nabla \delta \tensori{u}{}_{\cell}
        -
        \int_{\cell} \loadLag \cdot \delta \tensori{u}{}_{\cell}
        -
        \int_{\neumannCell} \neumannCellLoad \cdot \delta \tensori{u}{}_{\cell} \vert_{\dCell{}}
    \end{aligned}
\end{equation}
%
%
%
and that relates to the strong problem defined by equation \eqref{eq_model_problem:eq3}, \eqref{eq_model_problem:eq4}, \eqref{eq_model_problem:eq5} only, where \eqref{eq_model_problem:eq1}, \eqref{eq_model_problem:eq2} are taken to be granted.
%
%
%
% ,and $\cdot \ \vert_{\dCell}$ is the trace operator on $\dCell$.
% The equilibrium of the body $\cell$ corresponding to problem \eqref{eq_model_problem} where equations \eqref{eq_model_problem:eq1} and \eqref{eq_model_problem:eq2} are enforced strongly is reached for the displacement field $\tensori{u}{}_{\cell} \in \displacementSpaceCell$ verifying $\tensori{u}{}_{\cell} \vert_{\dirichletCell} = \dirichletLag$ on $\dirichletCell$ and minimizing the energy functional $J_{\cell}$:
% %
% % 
% % 
% \begin{equation}
%     \label{eq_virtual_works}
%     \begin{aligned}
%         J_{\cell}
%         % (\tensori{u}{}_{\cell})
%         =
%         \int_{\cell} \mecPotential{}_{\cell}
%         -
%         \int_{\cell} \loadLag \cdot \tensori{u}{}_{\cell}
%         -
%         \int_{\neumannCell} \neumannCellLoad \cdot \tensori{u}{}_{\cell}
%     \end{aligned}
% \end{equation}
% %
% % 
% % 
% The energy functional \eqref{eq_virtual_works} of the equilibrium of $T$ depends on the single displacement unknown, and is the one at the foundation of the notorious principle of virtual works; indeed, deriving \eqref{eq_virtual_works} with respect to $\tensori{u}{}_{\cell}$ and using both \eqref{eq_model_problem:eq1} and \eqref{eq_model_problem:eq2} yields :
% %
% % 
% % 
% \begin{equation}
%     \label{eq_virtual_works_1}
%     \begin{aligned}
%         % \frac{\partial J_{\cell}}{\partial \tensori{u}{}_{\cell}} \delta \tensori{u}{}_{\cell}
%         d J_{\cell} = \frac{\partial J_{\cell}}{\partial \tensori{u}{}_{\cell}} \delta \tensori{u}{}_{\cell}
%         & =
%         \int_{\cell}
%         % \frac{\partial \mecPotential{}_{\cell}}{\partial \nabla \tensori{u}{}_{\cell}} : \nabla \delta \tensori{u}{}_{\cell}
%         \tensorii{P}{}_{\cell} : \nabla \delta \tensori{u}{}_{\cell}
%         -
%         \int_{\cell} \loadLag \cdot \delta \tensori{u}{}_{\cell}
%         -
%         \int_{\neumannCell} \neumannCellLoad \cdot \delta \tensori{u}{}_{\cell} \vert_{\dCell{}}
%     \end{aligned}
% \end{equation}
% %
% % 
% % 
% with $\displacementSpaceCell{} = H^1(\cell, \mathbb{R}^{d})$. If $\tensorii{G}{}_{\cell}$ and $\tensorii{P}{}_{\cell}$ are unknowns of the problem, one obtains the three-field Hu–Washizu functional $J_{\cell}$, for the displacement field $\tensori{u}{}_{\cell} \in \displacementSpaceCell$ verifying $\tensori{u}{}_{\cell} \vert_{\dirichletCell} = \dirichletLag$ on $\dirichletCell$ such that :
% % 
% % 
% %
% % \begin{equation}
% % \label{eq_hu_washizu}
% %     J_{\cell}
% %     % (\tensori{u}{}_{\cell}, \tensorii{G}{}_{\cell}, \tensorii{P}{}_{\cell})
% %     =
% %     \int_{\cell} \mecPotential{}_{\cell} + (\nabla \tensori{u}{}_{\cell} - \tensorii{G}{}_{\cell}) : \tensorii{P}{}_{\cell}
% %     -
% %     \int_{\cell} \loadLag \cdot \tensori{u}{}_{\cell}
% %     -
% %     \int_{\neumannCell} \neumannCellLoad \cdot \tensori{u}{}_{\cell}
% % \end{equation}
% %
% % 
% % 
% Deriving \eqref{eq_hu_washizu} with respect to all variables of the problem expresses problem \eqref{eq_model_problem} in a weak sense :
% %
% % 
% % 
% \begin{subequations}
%     \label{eq_hu_washizu_derivative}
%         \begin{alignat}{3}
%             \frac{\partial J_{\cell}}{\partial \tensori{u}{}_{\cell}} \delta \tensori{u}{}_{\cell}
%             = & \int_{\cell} \tensorii{P}{}_{\cell} : \nabla \delta \tensori{u}{}_{\cell}
%             -
%             \int_{\cell} \tensori{f}{}_V \cdot \delta \tensori{u}{}_{\cell}
%             -
%             \int_{\dCell} \tensori{t}{}_{\neumannCell} \cdot \delta \tensori{u}{}_{\cell} \vert_{\dCell}
%             &&
%             \ \ \ \ \ \ \ \ 
%             &&
%             \forall \delta \tensori{u}{}_{\cell}
%             \in \displacementSpaceCell
%         \label{eq_hu_washizu_derivative:eq0}
%         \\
%             \frac{\partial J_{\cell}}{\partial \tensorii{G}{}_{\cell}} \delta \tensorii{G}{}_{\cell}
%             = &
%             \int_{\cell} (\frac{\partial \mecPotential_{\cell}}{\partial \tensorii{G}{}_{\cell}} - \tensorii{P}{}_{\cell}) : \delta \tensorii{G}{}_{\cell}
%             &&
%             \ \ \ \ \ \ \ \ 
%             &&
%             \forall \delta \tensorii{G}{}_{\cell}
%             \in \gradSpaceCell
%         \label{eq_hu_washizu_derivative:eq2}
%         \\
%             \frac{\partial J_{\cell}}{\partial \tensorii{P}{}_{\cell}} \delta \tensorii{P}{}_{\cell}
%             = & \int_{\cell} (\nabla \tensori{u}{}_{\cell} - \tensorii{G}{}_{\cell} ) : \delta \tensorii{P}{}_{\cell}
%             &&
%             \ \ \ \ \ \ \ \ 
%             &&
%             \forall \delta \tensorii{P}{}_{\cell}
%             \in \stressSpaceCell
%         \label{eq_hu_washizu_derivative:eq3}
%     \end{alignat}
% \end{subequations}
% %
% % 
% % 
% where the two supplementary equations \eqref{eq_hu_washizu_derivative:eq2} and \eqref{eq_hu_washizu_derivative:eq3} account for the weak formulation of \eqref{eq_model_problem:eq1} and \eqref{eq_model_problem:eq2}, and $\displacementSpaceCell{} = H^1(\cell, \mathbb{R}^{d})$ and $\gradSpaceCell = \stressSpaceCell = L^2(\cell, \mathbb{R}^{d \times d})$.

In particular, assuming $\cell = \bodyLag$, one obtains the mechanical problem to solve for the whole body $\bodyLag$.
Furthermore, assuming that $\cell$ is made out of a partition of $N > 0$ distinct media $\matI \subset \cell$ with respective energy potentials $\mecPotential{}_{\matI}$, the problem writes : for each medium $\matI$, find $\tensori{u}{}_{\matI} \in \displacementSpaceMatI$ verifying
$\tensori{u}{}_{\matI} \vert_{\dirichletMatI} = \dirichletLag$ on $\dirichletMatI$,
the displacement gradient field $\tensorii{G}{}_{\matI} \in \gradSpaceMatI$ and the first Piola-Kirchoff stress field $\tensorii{P}{}_{\matI} \in \stressSpaceMatI$, that minimize the functional
% 
% 
% 
\begin{equation}
\label{eq_hu_washizu_composite}
\begin{aligned}
    J_{\cell}^{HW}
    = & \sum_{1 \leq i \leq N} \int_{\matI} \mecPotential{}_{\matI} + (\nabla \tensori{u}{}_{\matI} - \tensorii{G}{}_{\matI}) : \tensorii{P}{}_{\matI}
    -
    \int_{\matI} \loadLag \cdot \tensori{u}{}_{\matI}
    -
    \int_{\neumannMatI \cap \neumannCell} \neumannCellLoad \cdot \tensori{u}{}_{\matI}
\end{aligned}
\end{equation}
%
% 
% 
where for all $1 \leq i \neq j \leq N$, the external forces corresponding to the traction applied by $\matI$ onto $\partial T_j \cap \dMatI$ and to that of $T_j$ onto $\dMatI \cap \partial T_j$ are direclty eliminated by continuity of the traction force across $\partial T_j \cap \dMatI$.
Assuming the fields to be continuous in $\cell$, one has :
$
\tensori{u}{}_{\matI} = \tensori{u}{}_{\cell} \vert_{\matI},
\tensorii{G}{}_{\matI} = \tensorii{G}{}_{\cell} \vert_{\matI},
\tensorii{P}{}_{\matI} = \tensorii{P}{}_{\cell} \vert_{\matI}
$,
and the problem simplifies in : find $\tensori{u}{}_{\cell} \in \displacementSpaceCell$
verifying $\tensori{u}{}_{\cell} \vert_{\dirichletCell} = \dirichletLag$ on $\dirichletCell$,
the displacement gradient field $\tensorii{G}{}_{\cell} \in \gradSpaceCell$
and the first Piola-Kirchoff stress field $\tensorii{P}{}_{\cell} \in \stressSpaceCell$ that minimize
%
% 
% 
\begin{equation}
\label{eq_hu_washizu_composite_continuous}
\begin{aligned}
    J_{\cell}^{HW}
    = & \sum_{1 \leq i \leq N} \int_{\matI} \mecPotential{}_{\matI} + (\nabla \tensori{u}{}_{\cell} - \tensorii{G}{}_{\cell}) : \tensorii{P}{}_{\cell}
    -
    \int_{\matI} \loadLag \cdot \tensori{u}{}_{\cell}
    -
    \int_{\neumannCell{}} \neumannCellLoad \cdot \tensori{u}{}_{\cell} \vert_{\dCell{}}
\end{aligned}
\end{equation}